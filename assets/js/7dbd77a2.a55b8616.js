"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6584],{3905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return f}});var i=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},a=Object.keys(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=i.createContext({}),c=function(e){var t=i.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},u=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=c(r),f=n,m=d["".concat(l,".").concat(f)]||d[f]||p[f]||a;return r?i.createElement(m,s(s({ref:t},u),{},{components:r})):i.createElement(m,s({ref:t},u))}));function f(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,s=new Array(a);s[0]=d;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:n,s[1]=o;for(var c=2;c<a;c++)s[c]=r[c];return i.createElement.apply(null,s)}return i.createElement.apply(null,r)}d.displayName="MDXCreateElement"},4892:function(e,t,r){r.r(t),r.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return f},frontMatter:function(){return o},metadata:function(){return c},toc:function(){return p}});var i=r(3117),n=r(102),a=(r(7294),r(3905)),s=["components"],o={sidebar_position:4},l="API A4 - Lack of Resources and Rate Limits",c={unversionedId:"OWASP-API-10/A4-Rate-Limits",id:"OWASP-API-10/A4-Rate-Limits",title:"API A4 - Lack of Resources and Rate Limits",description:"RATE-LIMITS",source:"@site/vulnerabilities/OWASP-API-10/A4-Rate-Limits.md",sourceDirName:"OWASP-API-10",slug:"/OWASP-API-10/A4-Rate-Limits",permalink:"/vulnerabilities/next/OWASP-API-10/A4-Rate-Limits",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"API A3 - Excessive Data Exposure",permalink:"/vulnerabilities/next/OWASP-API-10/A3-Excessive-Data-Exposure"},next:{title:"API A5 - Broken Function Level Authorization",permalink:"/vulnerabilities/next/OWASP-API-10/A5-BFLA"}},u={},p=[{value:"What is it?",id:"what-is-it",level:2},{value:"What are specific examples?",id:"what-are-specific-examples",level:2},{value:"References",id:"references",level:2},{value:"Test case FAQs",id:"test-case-faqs",level:2},{value:"When is this test case applicable?",id:"when-is-this-test-case-applicable",level:3},{value:"How does it work?",id:"how-does-it-work",level:2},{value:"What is the solution?",id:"what-is-the-solution",level:2}],d={toc:p};function f(e){var t=e.components,o=(0,n.Z)(e,s);return(0,a.kt)("wrapper",(0,i.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"api-a4---lack-of-resources-and-rate-limits"},"API A4 - Lack of Resources and Rate Limits"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"RATE-LIMITS",src:r(8435).Z,width:"609",height:"300"})),(0,a.kt)("h2",{id:"what-is-it"},"What is it?"),(0,a.kt)("p",null,"APIs need to restrict the size and/or the number of resources that can be requested by the client/user."),(0,a.kt)("p",null,"Lack of such controls lead to Denial of Service (DoS), degraded performance, and authentication flaws like brute force."),(0,a.kt)("h2",{id:"what-are-specific-examples"},"What are specific examples?"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Attackers overload the API by sending more requests than it can handle, causing degraded performance or complete Denial of Service."),(0,a.kt)("li",{parentName:"ul"},"The size of the requests or the size/value of certain fields in them, leads to degraded performance or complete Denial of Service. For example, API endpoints that accept an unrestricted page size, as a query parameter."),(0,a.kt)("li",{parentName:"ul"},"\u201cZip bombs\u201d, archive files that have been designed so that unpacking them takes excessive amount of resources and overloads the API.")),(0,a.kt)("h2",{id:"references"},"References"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://owasp.org/www-project-api-security/"},"OWASP API TOP-10 A4"),(0,a.kt)("br",{parentName:"p"}),"\n",(0,a.kt)("a",{parentName:"p",href:"https://cloud.google.com/architecture/rate-limiting-strategies-techniques"},"Rate Limiting - Best Practices")),(0,a.kt)("h2",{id:"test-case-faqs"},"Test case FAQs"),(0,a.kt)("h3",{id:"when-is-this-test-case-applicable"},"When is this test case applicable?"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Applicable to all API endpoints.")),(0,a.kt)("h2",{id:"how-does-it-work"},"How does it work?"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The endpoint is accessed at increasingly high frequencies to test for the absence of rate limit controls."),(0,a.kt)("li",{parentName:"ul"},"Based on the structure of the endpoint, certain strategic fields (e.g. page key, limit key, etc.) are set to large values, attempting to cause degraded performance or complete Denial of Service.")),(0,a.kt)("h2",{id:"what-is-the-solution"},"What is the solution?"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Define proper rate limiting for all endpoints by using industry standard frameworks."),(0,a.kt)("li",{parentName:"ul"},"Limit payload sizes."),(0,a.kt)("li",{parentName:"ul"},"Limit maximum values for strategic query fields like ",(0,a.kt)("inlineCode",{parentName:"li"},"page size"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"limit"),", etc."),(0,a.kt)("li",{parentName:"ul"},"Tailor the rate limiting to be match what API methods, clients, or addresses need or should be allowed to get."),(0,a.kt)("li",{parentName:"ul"},"Add checks on compression ratios."),(0,a.kt)("li",{parentName:"ul"},"Define limits for container resources.")))}f.isMDXComponent=!0},8435:function(e,t,r){t.Z=r.p+"assets/images/A4-Rate-Limits-e2e36656e2904e1c6b3ad6c0fa4e91f1.svg"}}]);