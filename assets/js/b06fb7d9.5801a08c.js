"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[246],{3905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return d}});var n=r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},u=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),h=c(r),d=i,f=h["".concat(l,".").concat(d)]||h[d]||p[d]||a;return r?n.createElement(f,s(s({ref:t},u),{},{components:r})):n.createElement(f,s({ref:t},u))}));function d(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=r.length,s=new Array(a);s[0]=h;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:i,s[1]=o;for(var c=2;c<a;c++)s[c]=r[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},9272:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return o},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return u},default:function(){return h}});var n=r(7462),i=r(3366),a=(r(7294),r(3905)),s=["components"],o={},l="Server Side Request Forgery (SSRF)",c={unversionedId:"issues/vulnerabilities/SSRF",id:"issues/vulnerabilities/SSRF",isDocsHomePage:!1,title:"Server Side Request Forgery (SSRF)",description:"SSRF",source:"@site/docs/issues/vulnerabilities/SSRF.md",sourceDirName:"issues/vulnerabilities",slug:"/issues/vulnerabilities/SSRF",permalink:"/issues/vulnerabilities/SSRF",editUrl:"https://github.com/levoai/docs/edit/main/docs/issues/vulnerabilities/SSRF.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Broken Object Level Authorization (aka IDOR)",permalink:"/issues/vulnerabilities/IDOR"},next:{title:"API Schema / Contract Non-Conformance",permalink:"/issues/schema-conformance"}},u=[{value:"What is it?",id:"what-is-it",children:[],level:2},{value:"References",id:"references",children:[],level:2},{value:"Test case FAQs",id:"test-case-faqs",children:[{value:"When is this test case applicable?",id:"when-is-this-test-case-applicable",children:[],level:3}],level:2},{value:"How does it work?",id:"how-does-it-work",children:[],level:2},{value:"What is the solution?",id:"what-is-the-solution",children:[],level:2}],p={toc:u};function h(e){var t=e.components,o=(0,i.Z)(e,s);return(0,a.kt)("wrapper",(0,n.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"server-side-request-forgery-ssrf"},"Server Side Request Forgery (SSRF)"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"SSRF",src:r(676).Z})),(0,a.kt)("h2",{id:"what-is-it"},"What is it?"),(0,a.kt)("p",null,"Server-side request forgery (also known as SSRF) is a security vulnerability that allows an attacker to induce the server-side application to make HTTP requests to an arbitrary domain of the attacker's choosing."),(0,a.kt)("p",null,"In a typical SSRF attack, the attacker might cause the server to make a connection to internal-only services within the organization's infrastructure. In other cases, they may be able to force the server to connect to arbitrary external systems, potentially leaking sensitive data such as authorization credentials.."),(0,a.kt)("h2",{id:"references"},"References"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://owasp.org/www-project-api-security/"},"MITRE CWE-918"),(0,a.kt)("br",{parentName:"p"}),"\n",(0,a.kt)("a",{parentName:"p",href:"https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/"},"OWASP Top 10 - A10"),(0,a.kt)("br",{parentName:"p"}),"\n",(0,a.kt)("a",{parentName:"p",href:"https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html"},"OWASP - SSRF Prevention Cheat Sheet")),(0,a.kt)("h2",{id:"test-case-faqs"},"Test case FAQs"),(0,a.kt)("h3",{id:"when-is-this-test-case-applicable"},"When is this test case applicable?"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"API endpoints that take client-supplied input specifying URLs, files, or other API endpoints")),(0,a.kt)("h2",{id:"how-does-it-work"},"How does it work?"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"The parameter(s) within the API endpoint, which take URLs (or files, or other API endpoints) as input, are injected with malicious data. The malicious data is typically a URL, that references an internal resource that should not be exposed externally (e.g. AWS instance meta data)."),(0,a.kt)("li",{parentName:"ol"},"If the API endpoint returns the internal resource, the API is deemed vulnerable to SSRF.")),(0,a.kt)("h2",{id:"what-is-the-solution"},"What is the solution?"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Sanitize all client-supplied input by creating a list of trusted URLs (lists of hosts or a regex). Use a whitelist approach to limit what URLs (or files, or other API endpoints) can be specified as inputs."),(0,a.kt)("li",{parentName:"ul"},"Restrict supported protocols in your web application. Disable any unused URL schemas. For example ftp://, dict://, file://, gopher://, etc."),(0,a.kt)("li",{parentName:"ul"},"With microservice architectures, communication between all internal services should be authenticated."),(0,a.kt)("li",{parentName:"ul"},"AWS: IMDSv2 is an additional defense mechanism for AWS that mitigates some instances of SSRF if you are using a cloud environment. Migrate to IMDSv2 and disable old IMDSv1. Check out the AWS ",(0,a.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html"},"documentation")," for more details.")))}h.isMDXComponent=!0},676:function(e,t,r){t.Z=r.p+"assets/images/SSRF-e4c157a92f98601945b634f57ecd6292.svg"}}]);