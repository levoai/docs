"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[104],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return u}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),c=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},f={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=c(a),u=r,m=d["".concat(s,".").concat(u)]||d[u]||f[u]||i;return a?n.createElement(m,l(l({ref:t},p),{},{components:a})):n.createElement(m,l({ref:t},p))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var c=2;c<i;c++)l[c]=a[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},7414:function(e,t,a){a.r(t),a.d(t,{assets:function(){return p},contentTitle:function(){return s},default:function(){return u},frontMatter:function(){return o},metadata:function(){return c},toc:function(){return f}});var n=a(3117),r=a(102),i=(a(7294),a(3905)),l=["components"],o={sidebar_position:3},s="API Traffic Capture Filters",c={unversionedId:"api-observability/common-tasks/sensor/filter-traffic",id:"api-observability/common-tasks/sensor/filter-traffic",title:"API Traffic Capture Filters",description:"The Sensor allows capturing API (HTTP) traffic based on filter (include/exclude) criteria. These filters are specified in a configuration file. Please refer to Sensor Configuration for high level structure of the file.",source:"@site/docs/api-observability/common-tasks/sensor/filter-traffic.md",sourceDirName:"api-observability/common-tasks/sensor",slug:"/api-observability/common-tasks/sensor/filter-traffic",permalink:"/api-observability/common-tasks/sensor/filter-traffic",draft:!1,editUrl:"https://github.com/levoai/docs/edit/main/docs/api-observability/common-tasks/sensor/filter-traffic.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Manage Sensor Configuration",permalink:"/api-observability/common-tasks/sensor/sensor-configuration"},next:{title:"Satellite Lifecycle Management",permalink:"/api-observability/common-tasks/satellite/satellite-mgmt"}},p={},f=[{value:"Default Excluded Ports",id:"default-excluded-ports",level:2},{value:"Configure IP Filters",id:"configure-ip-filters",level:2},{value:"IP Filter Examples",id:"ip-filter-examples",level:3},{value:"Exclude All Traffic",id:"exclude-all-traffic",level:4},{value:"Exclude Specific Ports/Port Ranges",id:"exclude-specific-portsport-ranges",level:4},{value:"Exclude Specific Host Ports/Port Ranges",id:"exclude-specific-host-portsport-ranges",level:5},{value:"Exclude Specific Peer Ports/Port Ranges",id:"exclude-specific-peer-portsport-ranges",level:5},{value:"Include Specific Ports/Port Ranges",id:"include-specific-portsport-ranges",level:4},{value:"Include Specific Host Ports/Port Ranges",id:"include-specific-host-portsport-ranges",level:5},{value:"Include Specific Peer Ports/Port Ranges",id:"include-specific-peer-portsport-ranges",level:5},{value:"Exclude Specific IP Addresses",id:"exclude-specific-ip-addresses",level:4},{value:"Exclude Specific HOST IP Addresses",id:"exclude-specific-host-ip-addresses",level:5},{value:"Exclude Specific Peer IP Addresses",id:"exclude-specific-peer-ip-addresses",level:5},{value:"Include Specific IP Addresses",id:"include-specific-ip-addresses",level:4},{value:"Include Specific HOST IP Addresses",id:"include-specific-host-ip-addresses",level:5},{value:"Exclude Specific Peer IP Addresses",id:"exclude-specific-peer-ip-addresses-1",level:5},{value:"Exclude IP Subnets",id:"exclude-ip-subnets",level:4},{value:"Exclude IP Subnets - CIDR Notation",id:"exclude-ip-subnets---cidr-notation",level:5},{value:"Exclude IP Subnets - Prefix Notation",id:"exclude-ip-subnets---prefix-notation",level:5},{value:"Include IP Subnets",id:"include-ip-subnets",level:4},{value:"Include IP Subnets - CIDR Notation",id:"include-ip-subnets---cidr-notation",level:5},{value:"Include IP Subnets - Prefix Notation",id:"include-ip-subnets---prefix-notation",level:5},{value:"Capture Traffic for Specific Processes",id:"capture-traffic-for-specific-processes",level:4},{value:"Capture Traffic by Command Name",id:"capture-traffic-by-command-name",level:5},{value:"Capture Traffic by PID",id:"capture-traffic-by-pid",level:5},{value:"Configure Kubernetes Pod Filters",id:"configure-kubernetes-pod-filters",level:2},{value:"K8s Pod Filter Configuration Section",id:"k8s-pod-filter-configuration-section",level:3},{value:"K8s Pod Filter Examples",id:"k8s-pod-filter-examples",level:3},{value:"Trace A Single Deployment In A Specific Namespace",id:"trace-a-single-deployment-in-a-specific-namespace",level:4},{value:"Ignore All Traffic Belonging To A Specific Namespace",id:"ignore-all-traffic-belonging-to-a-specific-namespace",level:4},{value:"Trace Multiple Deployments In A Specific Namespace",id:"trace-multiple-deployments-in-a-specific-namespace",level:4},{value:"Trace A Specific Deployment In A Namespace, And Trace All Other Namespaces",id:"trace-a-specific-deployment-in-a-namespace-and-trace-all-other-namespaces",level:4},{value:"Trace All Deployments and Statefulsets From Any Namespace",id:"trace-all-deployments-and-statefulsets-from-any-namespace",level:4},{value:"Ignore Traffic From K8s System Level Services",id:"ignore-traffic-from-k8s-system-level-services",level:4},{value:"Configure URL Filters",id:"configure-url-filters",level:2},{value:"URL Filter Configuration Section",id:"url-filter-configuration-section",level:3},{value:"URL Filter Examples",id:"url-filter-examples",level:3},{value:"Ignore All <code>.js</code> API Endpoints",id:"ignore-all-js-api-endpoints",level:4},{value:"Ignore API Base Path <code>/static/</code>",id:"ignore-api-base-path-static",level:4},{value:"Ignore API Endpoints With Query Parameter <code>timeout</code>",id:"ignore-api-endpoints-with-query-parameter-timeout",level:4},{value:"Only Trace API Endpoints Containing <code>/users/</code>",id:"only-trace-api-endpoints-containing-users",level:4},{value:"Only Trace <code>GET/POST</code> API Endpoints",id:"only-trace-getpost-api-endpoints",level:4},{value:"Only Trace <code>payments.com:8888</code> APIs",id:"only-trace-paymentscom8888-apis",level:4},{value:"Only Trace <code>payments.com:8888/credit/</code> APIs Doing <code>GET</code>",id:"only-trace-paymentscom8888credit-apis-doing-get",level:4},{value:"Trace APIs on All Subdomains of <code>api.acme.com</code>",id:"trace-apis-on-all-subdomains-of-apiacmecom",level:4}],d={toc:f};function u(e){var t=e.components,o=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,n.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"api-traffic-capture-filters"},"API Traffic Capture Filters"),(0,i.kt)("p",null,"The Sensor allows capturing API (HTTP) traffic based on filter (include/exclude) criteria. These filters are specified in a configuration file. Please refer to ",(0,i.kt)("a",{parentName:"p",href:"/api-observability/common-tasks/sensor/sensor-configuration"},"Sensor Configuration")," for high level structure of the file."),(0,i.kt)("p",null,"The sensor's fundamental unit at which filtering criteria are applied is a ",(0,i.kt)("inlineCode",{parentName:"p"},"Linux Process"),"."),(0,i.kt)("p",null,"The sensor can filter traffic based on Linux Process names, Linux Process IDs, IP address tuples associated with a Linux Process's TCP/UDP traffic, Kubernetes Pod metadata associated with the Linux Process (when running on Kubernetes), and HTTP URL/header information in traffic being processed by the Linux Process."),(0,i.kt)("p",null,"Below diagram shows the outcomes and precedence, when the various filtering criteria mentioned above are combined together."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"API Filter Precedence",src:a(6975).Z,width:"1409",height:"747"})),(0,i.kt)("p",null,"Below are details on the supported filtering criteria."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"#default-excluded-ports"},(0,i.kt)("strong",{parentName:"a"},"Default Excluded Ports"))," ",(0,i.kt)("br",null))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"#configure-ip-filters"},(0,i.kt)("strong",{parentName:"a"},"Configure IP Filters"))," ",(0,i.kt)("br",null)),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#ip-filter-examples"},(0,i.kt)("strong",{parentName:"a"},"IP Filter Examples"))," ",(0,i.kt)("br",null),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#exclude-all-traffic"},"Exclude All Traffic")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#exclude-specific-portsport-ranges"},"Exclude Specific Ports/Port Ranges")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#include-specific-portsport-ranges"},"Include Specific Ports/Port Ranges")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#exclude-specific-ip-addresses"},"Exclude Specific IP Addresses")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#include-specific-ip-addresses"},"Include Specific IP Addresses")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#exclude-ip-subnets"},"Exclude IP Subnets")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#include-ip-subnets"},"Include IP Subnets")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#capture-traffic-for-specific-processes"},"Capture Traffic for Specific Processes")))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"#configure-kubernetes-pod-filters"},(0,i.kt)("strong",{parentName:"a"},"Configure Kubernetes Pod Filters"))," ",(0,i.kt)("br",null)),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#k8s-pod-filter-examples"},(0,i.kt)("strong",{parentName:"a"},"K8s Pod Filter Examples"))," ",(0,i.kt)("br",null),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#trace-a-single-deployment-in-a-specific-namespace"},"Trace A Single Deployment In A Specific Namespace")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#ignore-all-traffic-belonging-to-a-specific-namespace"},"Ignore All Traffic Belonging To A Specific Namespace")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#trace-multiple-deployments-in-a-specific-namespace"},"Trace Multiple Deployments In A Specific Namespace")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#trace-a-specific-deployment-in-a-namespace-and-trace-all-other-namespaces"},"Trace A Specific Deployment In A Namespace, And Trace All Other Namespaces")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#trace-all-deployments-and-statefulsets-from-any-namespace"},"Trace All Deployments and Statefulsets From Any Namespace")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#ignore-traffic-from-k8s-system-level-services"},"Ignore Traffic From K8s System Level Services")))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"#configure-url-filters"},(0,i.kt)("strong",{parentName:"a"},"Configure URL Filters"))," ",(0,i.kt)("br",null)),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#url-filter-examples"},(0,i.kt)("strong",{parentName:"a"},"URL Filter Examples"))," ",(0,i.kt)("br",null),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#ignore-all-js-api-endpoints"},"Ignore All ",(0,i.kt)("inlineCode",{parentName:"a"},".js")," API Endpoints")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#ignore-api-base-path-static"},"Ignore API Base Path ",(0,i.kt)("inlineCode",{parentName:"a"},"/static/"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#ignore-api-endpoints-with-query-parameter-timeout"},"Ignore API Endpoints With Query Parameter ",(0,i.kt)("inlineCode",{parentName:"a"},"timeout"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#only-trace-api-endpoints-containing-users"},"Only Trace API Endpoints Containing ",(0,i.kt)("inlineCode",{parentName:"a"},"/users/"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#only-trace-getpost-api-endpoints"},"Only Trace ",(0,i.kt)("inlineCode",{parentName:"a"},"GET/POST")," API Endpoints")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#only-trace-paymentscom8888-apis"},"Only Trace ",(0,i.kt)("inlineCode",{parentName:"a"},"payments.com:8888")," APIs")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#only-trace-paymentscom8888credit-apis-doing-get"},"Only Trace ",(0,i.kt)("inlineCode",{parentName:"a"},"payments.com:8888/credit/")," APIs Doing ",(0,i.kt)("inlineCode",{parentName:"a"},"GET"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#trace-apis-on-all-subdomains-of-apiacmecom"},"Trace APIs on All Subdomains of ",(0,i.kt)("inlineCode",{parentName:"a"},"api.acme.com")))))))),(0,i.kt)("br",null),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"default-excluded-ports"},"Default Excluded Ports"),(0,i.kt)("p",null,"The Sensor excludes capturing traffic from the below ports (TCP & UDP) by default."),(0,i.kt)("p",null,"If your API Traffic (HTTP) uses one of these ports, please see section below on how the port can be included for capture. "),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Standard Protocol"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Port"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"DNS"),(0,i.kt)("td",{parentName:"tr",align:"left"},"53")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"etcd"),(0,i.kt)("td",{parentName:"tr",align:"left"},"2379-2380")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"Kafka"),(0,i.kt)("td",{parentName:"tr",align:"left"},"9092-9093")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"mongodb"),(0,i.kt)("td",{parentName:"tr",align:"left"},"27017-27019, 28017")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"SQL Server"),(0,i.kt)("td",{parentName:"tr",align:"left"},"135, 4022, 1433-1434")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"MySQL"),(0,i.kt)("td",{parentName:"tr",align:"left"},"3306, 33060-33062")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"Postgress"),(0,i.kt)("td",{parentName:"tr",align:"left"},"5432-5433")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"RabbitMQ"),(0,i.kt)("td",{parentName:"tr",align:"left"},"5671-5672, 15672-15675, 25672, 35672-35682, 61613-61614")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"Redis"),(0,i.kt)("td",{parentName:"tr",align:"left"},"6379")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"ZooKeeper"),(0,i.kt)("td",{parentName:"tr",align:"left"},"2181, 3888, 3888")))),(0,i.kt)("br",null),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"configure-ip-filters"},"Configure IP Filters"),(0,i.kt)("p",null,"The below sections describe common filtering scenarios with examples. In all cases the examples show the relevant snippet of the configuration file. Adapt these examples to the ",(0,i.kt)("a",{target:"_blank",href:a(2749).Z},"Helm Values config file"),", if running on Kubernetes."),(0,i.kt)("h3",{id:"ip-filter-examples"},"IP Filter Examples"),(0,i.kt)("h4",{id:"exclude-all-traffic"},"Exclude All Traffic"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: drop # Default policy is to drop all traffic\n")),(0,i.kt)("h4",{id:"exclude-specific-portsport-ranges"},"Exclude Specific Ports/Port Ranges"),(0,i.kt)("h5",{id:"exclude-specific-host-portsport-ranges"},"Exclude Specific Host Ports/Port Ranges"),(0,i.kt)("p",null,"Host Port is the server listening port, where client/peer connections are accepted."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: accept # Default policy is to capture all traffic\n  entries: # Specific 'entries' can override the default policy\n    ### Host Ports ###\n    # Host Port is the server listening port, where client connections are accepted\n    - policy: drop\n      host-ports: 53 # DNS\n    - policy: drop\n      host-ports: 2379-2380 # etcd\n")),(0,i.kt)("h5",{id:"exclude-specific-peer-portsport-ranges"},"Exclude Specific Peer Ports/Port Ranges"),(0,i.kt)("p",null,"Peer Port is a client port used in communication with the server listening port."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: accept # Default policy is to capture all traffic\n  entries: # Specific 'entries' can override the default policy\n### Peer Ports ###\n    # Peer Port is the client port used in communication with the server listening port\n    - policy: drop\n      peer-ports: 9000\n    - policy: drop\n      peer-ports: 25000-29000 \n")),(0,i.kt)("h4",{id:"include-specific-portsport-ranges"},"Include Specific Ports/Port Ranges"),(0,i.kt)("h5",{id:"include-specific-host-portsport-ranges"},"Include Specific Host Ports/Port Ranges"),(0,i.kt)("p",null,"Host Port is the server listening port, where client/peer connections are accepted."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: drop # Drop all traffic except ones below\n  entries: # Specific 'entries' can override the default policy\n    ### Host Ports ###\n    # Host Port is the server listening port, where client connections are accepted\n    - policy: accept\n      host-ports: 9000\n    - policy: accept\n      host-ports: 23000-28000\n")),(0,i.kt)("h5",{id:"include-specific-peer-portsport-ranges"},"Include Specific Peer Ports/Port Ranges"),(0,i.kt)("p",null,"Peer Port is a client port used in communication with the server listening port."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: drop # Drop all traffic except ones below\n  entries: # Specific 'entries' can override the default policy\n### Peer Ports ###\n    # Peer Port is the client port used in communication with the server listening port\n    - policy: accept\n      peer-ports: 9000\n    - policy: accept\n      peer-ports: 25000-29000 \n")),(0,i.kt)("h4",{id:"exclude-specific-ip-addresses"},"Exclude Specific IP Addresses"),(0,i.kt)("h5",{id:"exclude-specific-host-ip-addresses"},"Exclude Specific HOST IP Addresses"),(0,i.kt)("p",null,"Host implies the binding IP addresses of the Server servicing the API endpoints."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: accept # Accept all traffic except ones below\n  entries: # Specific 'entries' can override the default policy\n    - host-network: 10.98.76.53 # Drop all traffic to/from 10.98.76.53\n      policy: drop\n    - host-network: 10.99.76.53 # Drop all traffic to/from 10.99.76.53\n      policy: drop\n")),(0,i.kt)("h5",{id:"exclude-specific-peer-ip-addresses"},"Exclude Specific Peer IP Addresses"),(0,i.kt)("p",null,"Peer implies the IP addresses of clients connecting to the Server/Host servicing the API endpoints."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: accept # Accept all traffic except ones below\n  entries: # Specific 'entries' can override the default policy\n    - peer-network: 10.98.76.53 # Drop all traffic to/from 10.98.76.53\n      policy: drop\n    - peer-network: 10.99.76.53 # Drop all traffic to/from 10.99.76.53\n      policy: drop\n")),(0,i.kt)("h4",{id:"include-specific-ip-addresses"},"Include Specific IP Addresses"),(0,i.kt)("h5",{id:"include-specific-host-ip-addresses"},"Include Specific HOST IP Addresses"),(0,i.kt)("p",null,"Host implies the binding IP addresses of the Server servicing the API endpoints."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: drop # Drop all traffic except ones below\n  entries: # Specific 'entries' can override the default policy\n    - host-network: 10.98.76.53 # Accept all traffic to/from 10.98.76.53\n      policy: accept\n    - host-network: 10.99.76.53 # Accept all traffic to/from 10.99.76.53\n      policy: accept\n")),(0,i.kt)("h5",{id:"exclude-specific-peer-ip-addresses-1"},"Exclude Specific Peer IP Addresses"),(0,i.kt)("p",null,"Peer implies the IP addresses of clients connecting to the Server/Host servicing the API endpoints."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: drop # Drop all traffic except ones below\n  entries: # Specific 'entries' can override the default policy\n    - peer-network: 10.98.76.53 # Drop all traffic to/from 10.98.76.53\n      policy: accept\n    - peer-network: 10.99.76.53 # Drop all traffic to/from 10.99.76.53\n      policy: accept\n")),(0,i.kt)("h4",{id:"exclude-ip-subnets"},"Exclude IP Subnets"),(0,i.kt)("p",null,"Entire classes of subnets can be excluded using either the CIDR or prefix notations.\nThe examples below are for ",(0,i.kt)("inlineCode",{parentName:"p"},"host-network")," subnets. The same technique is applicable for ",(0,i.kt)("inlineCode",{parentName:"p"},"peer-network")," subnets."),(0,i.kt)("h5",{id:"exclude-ip-subnets---cidr-notation"},"Exclude IP Subnets - CIDR Notation"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: accept # Accept all traffic except ones below\n  entries: # Specific 'entries' can override the default policy\n    - host-network: 1.2.3.4/255.255.255.252 # Drop all from/to this host CIDR block\n      policy: drop\n")),(0,i.kt)("h5",{id:"exclude-ip-subnets---prefix-notation"},"Exclude IP Subnets - Prefix Notation"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: accept # Accept all traffic except ones below\n  entries: # Specific 'entries' can override the default policy\n    - host-network: 1.2.3.4/30 # Drop all from/to this host subnet block\n      policy: drop\n")),(0,i.kt)("h4",{id:"include-ip-subnets"},"Include IP Subnets"),(0,i.kt)("p",null,"Entire classes of subnets can be included using either the CIDR or prefix notations.\nThe examples below are for ",(0,i.kt)("inlineCode",{parentName:"p"},"host-network")," subnets. The same technique is applicable for ",(0,i.kt)("inlineCode",{parentName:"p"},"peer-network")," subnets."),(0,i.kt)("h5",{id:"include-ip-subnets---cidr-notation"},"Include IP Subnets - CIDR Notation"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: drop # Drop all traffic except ones below\n  entries: # Specific 'entries' can override the default policy\n    - host-network: 1.2.3.4/255.255.255.252 # Accept all to/from this host CIDR block\n      policy: accept\n")),(0,i.kt)("h5",{id:"include-ip-subnets---prefix-notation"},"Include IP Subnets - Prefix Notation"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: drop # Drop all traffic except ones below\n  entries: # Specific 'entries' can override the default policy\n    - host-network: 1.2.3.4/30 # Accept all to/from this host subnet block\n      policy: accept\n")),(0,i.kt)("h4",{id:"capture-traffic-for-specific-processes"},"Capture Traffic for Specific Processes"),(0,i.kt)("p",null,"Traffic can be captured ONLY for specific processes, by specifying either their command name or PID."),(0,i.kt)("h5",{id:"capture-traffic-by-command-name"},"Capture Traffic by Command Name"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# Process Filters: process command names/IDs to monitor & capture API traffic.\n# --------------------------------------------------------------------------------------------\n# Uncomment and modify appropriately to limit capture to specific process names or IDs.\n# Both monitored-commands and monitored-pids support list of names & IDs respectively.\n# NOTE: monitored-commands and monitored-pids settings are mutually exclusive\n\n# Capture traffic from/to nginx & python3\nmonitored-commands:\n  - nginx\n  - python3\n\n# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: accept # Default policy is to capture all traffic\n")),(0,i.kt)("h5",{id:"capture-traffic-by-pid"},"Capture Traffic by PID"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# Process Filters: process command names/IDs to monitor & capture API traffic.\n# --------------------------------------------------------------------------------------------\n# Uncomment and modify appropriately to limit capture to specific process names or IDs.\n# Both monitored-commands and monitored-pids support list of names & IDs respectively.\n# NOTE: monitored-commands and monitored-pids settings are mutually exclusive\n\n# Capture traffic from/to PIDs 123 & 45.\nmonitored-pids:\n  - 123\n  - 45\n\n# --------------------------------------------------------------------------------------------\n# IP Filters: IP/Port/Network address based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\n# IP Filters enable granular capture of API traffic based on various criteria.\n# Default values ignore traffic from standard ports that normally do not carry HTTP traffic.\n# Refer to documentation on how these can be customized to suit your environment.\nip-filter-list:\n  default-policy: accept # Default policy is to capture all traffic\n")),(0,i.kt)("h2",{id:"configure-kubernetes-pod-filters"},"Configure Kubernetes Pod Filters"),(0,i.kt)("p",null,"The sensor allows filtering of API traffic based on the Kubernetes Pod's metadata. Examples are including/excluding API traffic from a Pod belonging to specific ",(0,i.kt)("inlineCode",{parentName:"p"},"namespaces"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"deployments"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"statefulsets"),", etc."),(0,i.kt)("h3",{id:"k8s-pod-filter-configuration-section"},"K8s Pod Filter Configuration Section"),(0,i.kt)("p",null,"K8s Pod filters are configured in the ",(0,i.kt)("inlineCode",{parentName:"p"},"k8s-pod-filter-list")," section of the ",(0,i.kt)("a",{target:"_blank",href:a(2749).Z},"Helm Values config file")," as shown below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"sensor:\n  config:\n  # --------------------------------------------------------------------------------------------\n    # Kubernetes Pod Filters: Kubernetes pod properties based granular filtering of API traffic.\n    # --------------------------------------------------------------------------------------------\n    # Pod Filters enable granular capture of API traffic based on Kubernetes Pod attributes.\n    # Rules should ideally be in decreasing order of specificity.\n    # The first rule to match a pod's properties will be used.\n    # --------------------------------------------------------------------------------------------\n    #\n    k8s-pod-filter-list:\n      default-policy: <trace|ignore>\n      rules:\n        - policy: <trace|ignore>\n          namespace: <name or regex pattern>\n          # Optional owner reference of the Pod\n          owner-reference:\n            kind: <Node|Deployment>\n            name: <name or regex pattern>\n  # --------------------------------------------------------------------------------------------\n")),(0,i.kt)("h3",{id:"k8s-pod-filter-examples"},"K8s Pod Filter Examples"),(0,i.kt)("p",null,"Below are common filtering scenarios with examples. In all cases the examples show the relevant snippet of the configuration file. Adapt these examples to the ",(0,i.kt)("a",{target:"_blank",href:a(2749).Z},"Helm Values config file"),"."),(0,i.kt)("h4",{id:"trace-a-single-deployment-in-a-specific-namespace"},"Trace A Single Deployment In A Specific Namespace"),(0,i.kt)("p",null,"Below example will only trace all API traffic belonging to ",(0,i.kt)("inlineCode",{parentName:"p"},"entity-service")," Deployment in the ",(0,i.kt)("inlineCode",{parentName:"p"},"levoai")," Namespace, and ignore all other API traffic in the K8s cluster."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"k8s-pod-filter-list:  \n  default-policy: ignore\n  rules:  \n    - policy: trace\n      namespace: levoai\n      owner-reference:\n        kind: Deployment\n        name: entity-service\n\n")),(0,i.kt)("h4",{id:"ignore-all-traffic-belonging-to-a-specific-namespace"},"Ignore All Traffic Belonging To A Specific Namespace"),(0,i.kt)("p",null,"Below example will trace all API traffic in a K8s cluster, except traffic belonging to Pods in the ",(0,i.kt)("inlineCode",{parentName:"p"},"levoai")," namespace."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"k8s-pod-filter-list:  \n  default-policy: trace\n  rules:  \n    - policy: ignore\n      namespace: levoai\n")),(0,i.kt)("h4",{id:"trace-multiple-deployments-in-a-specific-namespace"},"Trace Multiple Deployments In A Specific Namespace"),(0,i.kt)("p",null,"Below example will only trace all API traffic belonging to ",(0,i.kt)("inlineCode",{parentName:"p"},"entity-service"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"onboarding-service")," Deployments in the ",(0,i.kt)("inlineCode",{parentName:"p"},"levoai")," Namespace, and ignore all other API traffic in the K8s cluster."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"k8s-pod-filter-list:  \n  default-policy: ignore\n  rules:  \n    - policy: trace\n      namespace: levoai\n      owner-reference:\n        kind: Deployment\n        name: (entity|onboarding)-service\n\n")),(0,i.kt)("h4",{id:"trace-a-specific-deployment-in-a-namespace-and-trace-all-other-namespaces"},"Trace A Specific Deployment In A Namespace, And Trace All Other Namespaces"),(0,i.kt)("p",null,"The below example does the following:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Traces all API traffic in all namespaces, except traffic within the ",(0,i.kt)("inlineCode",{parentName:"li"},"crapi")," namespace"),(0,i.kt)("li",{parentName:"ul"},"Trace traffic belonging to ",(0,i.kt)("inlineCode",{parentName:"li"},"crapi-identity")," Deployment in the ",(0,i.kt)("inlineCode",{parentName:"li"},"crapi")," namespace")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"k8s-pod-filter-list:  \n  default-policy: trace  \n  rules:  \n    - policy: trace  \n      namespace: crapi  \n      owner-reference:  \n        kind: Deployment  \n        name: crapi-identity  \n    - policy: ignore  \n      namespace: crapi\n")),(0,i.kt)("h4",{id:"trace-all-deployments-and-statefulsets-from-any-namespace"},"Trace All Deployments and Statefulsets From Any Namespace"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"k8s-pod-filter-list:  \n  default-policy: ignore\n  rules:  \n    - policy: trace\n      owner-reference:\n        kind: Deployment\n        namespace: .*\n    - policy: trace\n      owner-reference:\n        kind: StatefulSet\n        name: .*\n")),(0,i.kt)("h4",{id:"ignore-traffic-from-k8s-system-level-services"},"Ignore Traffic From K8s System Level Services"),(0,i.kt)("p",null,"Below example ignores all API traffic from kube, istio and levoai namespaces. It also ignores pods created by the K8s Nodes. All other traffic is traced."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"k8s-pod-filter-list:  \n  default-policy: trace\n  rules:  \n    - policy: ignore\n      namespace: kube-.*\n    - policy: ignore\n      namespace: istio.*\n    - policy: ignore\n      namespace: levoai\n    - policy: ignore\n      namespace: .*\n      owner-reference:\n        kind: Node\n        name: .*\n")),(0,i.kt)("h2",{id:"configure-url-filters"},"Configure URL Filters"),(0,i.kt)("p",null,"The sensor allows filtering of API traffic based on the ",(0,i.kt)("em",{parentName:"p"},"API endpoint Method (operation)"),", the ",(0,i.kt)("em",{parentName:"p"},"API Host")," (Host Header), and the ",(0,i.kt)("em",{parentName:"p"},"API endpoint's URI"),". The endpoint's URI can be a ",(0,i.kt)("a",{parentName:"p",href:"https://perldoc.perl.org/perlre"},"(Perl format)")," regex pattern."),(0,i.kt)("p",null,"Please ensure that any ",(0,i.kt)("a",{parentName:"p",href:"https://perldoc.perl.org/perlre#Metacharacters"},"regex metacharacters")," present in the URI string expression are properly escaped (for example ",(0,i.kt)("inlineCode",{parentName:"p"},"?"),", etc.). Use an ",(0,i.kt)("a",{parentName:"p",href:"https://regex101.com/"},"online regex evaluator")," to test your regex pattern if necessary."),(0,i.kt)("h3",{id:"url-filter-configuration-section"},"URL Filter Configuration Section"),(0,i.kt)("p",null,"URL filters are configured in the ",(0,i.kt)("inlineCode",{parentName:"p"},"url-filter")," section of the config file as shown below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# URL Filters: API parameter based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\nurl-filter:\n  # 'default-url-action' specifies the default behavior which can be overridden by 'rules' below.\n  # This is a mandatory attribute that needs to be specified in order to use URL filters.\n  default-url-action: <trace|ignore>\n  #\n  # YAML array of one or more rules. Order of rules matters during evaluation\n  rules:\n    # 'action' is mandatory. At least one of 'methods', or 'request-uri', or 'host'\n    # MUST be specified for each rule entry\n    - action: <trace|ignore>\n      #\n      # YAML array list of one or more (API operations) methods: GET, POST, PUT, PATCH, DELETE\n      # Example: [GET], or [GET, POST, PUT, DELETE]\n      methods: <[GET, POST, PUT, PATCH, DELETE]>\n      #\n      # URI of the API endpoint. Can be a (Perl format) regex pattern. Example: /foo/bar, or /bar/*\n      request-uri: <URI>\n      #\n      # Hostname of the API endpoint and optionally the port. Example: levo.ai:8888, or levo.ai\n      host: <hostname[:port]>\n      #\n# --------------------------------------------------------------------------------------------\n")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"default-url-action")," specifies the default behavior for filtering APIs, and is a ",(0,i.kt)("strong",{parentName:"p"},"mandatory")," attribute. Either all API endpoints are traced, or all are ignored. This default behavior can be overridden to granularly trace or ignore specific endpoints that match rules specified in the ",(0,i.kt)("inlineCode",{parentName:"p"},"rules")," sub section. "),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"rules")," sub section defines the override behavior using a YAML array list. Each entry of the array list is comprised of the following parameters:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"action"),": mandatory parameter that accepts either ",(0,i.kt)("inlineCode",{parentName:"li"},"trace")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"ignore")," as values"),(0,i.kt)("li",{parentName:"ul"},"At least one, and optionally all of the below additional parameters:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"methods"),": YAML array list of one or more (API operations) methods as values: GET, POST, PUT, PATCH, DELETE"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"request-uri"),": URI of the API endpoint as the value. Can be a (Perl format) regex pattern. Example: ",(0,i.kt)("inlineCode",{parentName:"li"},"/foo/bar"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"/bar/*")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"host"),": Hostname of the API endpoint and optionally the port as values. Can be a (Perl format) regex pattern. Example: ",(0,i.kt)("inlineCode",{parentName:"li"},"levo.ai:8888"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"levo.ai"),", or a regex such as ",(0,i.kt)("inlineCode",{parentName:"li"},".*\\.levo\\.ai")," to handle all subdomains of levo.ai")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Rule entries are evaluated in the order in which they were specified"),". Further evaluation stops, as soon as a single rule entry matches."),(0,i.kt)("h3",{id:"url-filter-examples"},"URL Filter Examples"),(0,i.kt)("p",null,"Below are common filtering scenarios with examples. In all cases the examples show the relevant snippet of the configuration file. Adapt these examples to the ",(0,i.kt)("a",{target:"_blank",href:a(2749).Z},"Helm Values config file"),", if running on Kubernetes."),(0,i.kt)("h4",{id:"ignore-all-js-api-endpoints"},"Ignore All ",(0,i.kt)("inlineCode",{parentName:"h4"},".js")," API Endpoints"),(0,i.kt)("p",null,"The below filter will ignore all API endpoints with URIs ending with ",(0,i.kt)("inlineCode",{parentName:"p"},".js"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# URL Filters: API parameter based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\nurl-filter:\n  default-url-action: trace\n  rules:\n    - action: ignore\n      request-uri: .*\\.js # Regex pattern to ignore all API endpoints which end with '.js' \n# --------------------------------------------------------------------------------------------\n")),(0,i.kt)("h4",{id:"ignore-api-base-path-static"},"Ignore API Base Path ",(0,i.kt)("inlineCode",{parentName:"h4"},"/static/")),(0,i.kt)("p",null,"The below filter will ignore all API endpoints that have the base path ",(0,i.kt)("inlineCode",{parentName:"p"},"/static/"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# URL Filters: API parameter based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\nurl-filter:\n  default-url-action: trace\n  rules:\n    - action: ignore\n      request-uri: /static/.*\n# --------------------------------------------------------------------------------------------\n")),(0,i.kt)("h4",{id:"ignore-api-endpoints-with-query-parameter-timeout"},"Ignore API Endpoints With Query Parameter ",(0,i.kt)("inlineCode",{parentName:"h4"},"timeout")),(0,i.kt)("p",null,"The below filter will ignore all endpoints that have the query parameter ",(0,i.kt)("inlineCode",{parentName:"p"},"timeout"),". For example ",(0,i.kt)("inlineCode",{parentName:"p"},"/users/list?timeout=60"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# URL Filters: API parameter based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\nurl-filter:\n  default-url-action: trace\n  rules:\n    - action: ignore\n      request-uri: .*\\?.*timeout=.* # Notice '?' is escaped with '\\?'\n# --------------------------------------------------------------------------------------------\n")),(0,i.kt)("h4",{id:"only-trace-api-endpoints-containing-users"},"Only Trace API Endpoints Containing ",(0,i.kt)("inlineCode",{parentName:"h4"},"/users/")),(0,i.kt)("p",null,"The below filter will ONLY trace all API endpoints that have ",(0,i.kt)("inlineCode",{parentName:"p"},"/users/")," in the path."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# URL Filters: API parameter based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\nurl-filter:\n  default-url-action: ignore # Ignore all API endpoints by default\n  rules:\n    - action: trace\n      request-uri: .*/users/.*\n# --------------------------------------------------------------------------------------------\n")),(0,i.kt)("h4",{id:"only-trace-getpost-api-endpoints"},"Only Trace ",(0,i.kt)("inlineCode",{parentName:"h4"},"GET/POST")," API Endpoints"),(0,i.kt)("p",null,"The below filter will ONLY trace all API endpoints that perform ",(0,i.kt)("em",{parentName:"p"},"GET or POST"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# URL Filters: API parameter based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\nurl-filter:\n  default-url-action: ignore # Ignore all API endpoints by default\n  rules:\n    - action: trace\n      methods: [GET, POST]\n# --------------------------------------------------------------------------------------------\n")),(0,i.kt)("h4",{id:"only-trace-paymentscom8888-apis"},"Only Trace ",(0,i.kt)("inlineCode",{parentName:"h4"},"payments.com:8888")," APIs"),(0,i.kt)("p",null,"The below filter will ONLY trace API endpoints belonging to API host ",(0,i.kt)("em",{parentName:"p"},"payments.com:8888"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# URL Filters: API parameter based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\nurl-filter:\n  default-url-action: ignore # Ignore all API endpoints by default\n  rules:\n    - action: trace\n      host: payments.com:8888\n# --------------------------------------------------------------------------------------------\n")),(0,i.kt)("h4",{id:"only-trace-paymentscom8888credit-apis-doing-get"},"Only Trace ",(0,i.kt)("inlineCode",{parentName:"h4"},"payments.com:8888/credit/")," APIs Doing ",(0,i.kt)("inlineCode",{parentName:"h4"},"GET")),(0,i.kt)("p",null,"The below filter will ONLY trace API endpoints belonging to API host ",(0,i.kt)("em",{parentName:"p"},"payments.com:8888"),", having ",(0,i.kt)("em",{parentName:"p"},"/credit/")," as the\nbase path, and performing ",(0,i.kt)("inlineCode",{parentName:"p"},"GET"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# URL Filters: API parameter based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\nurl-filter:\n  default-url-action: ignore # Ignore all API endpoints by default\n  rules:\n    - action: trace\n      host: payments.com:8888\n      methods: [GET]\n      request-uri: /credit/.*\n# --------------------------------------------------------------------------------------------\n")),(0,i.kt)("h4",{id:"trace-apis-on-all-subdomains-of-apiacmecom"},"Trace APIs on All Subdomains of ",(0,i.kt)("inlineCode",{parentName:"h4"},"api.acme.com")),(0,i.kt)("p",null,"The below filter will ONLY trace API endpoints belonging to all subdomains of API host ",(0,i.kt)("em",{parentName:"p"},"acme.com"),". For example API endpoints belonging to ",(0,i.kt)("em",{parentName:"p"},"payments.api.acme.com"),", and ",(0,i.kt)("em",{parentName:"p"},"orders.api.acme.com"),", will be traced, but ",(0,i.kt)("em",{parentName:"p"},"catalog.acme.com")," will be ignored."),(0,i.kt)("p",null,"The Host header is expressed as a Perl format regular expression."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# --------------------------------------------------------------------------------------------\n# URL Filters: API parameter based granular filtering of API traffic.\n# --------------------------------------------------------------------------------------------\nurl-filter:\n  default-url-action: ignore # Ignore all API endpoints by default\n  rules:\n    - action: trace\n      host: .*\\.api\\.acme\\.com # '.' has been escaped as we are using a regex\n# --------------------------------------------------------------------------------------------\n")))}u.isMDXComponent=!0},2749:function(e,t,a){t.Z=a.p+"assets/files/config-values-3e4e3b1e1fb8c15f9f03462493338240.yml"},6975:function(e,t,a){t.Z=a.p+"assets/images/Sensor-API-Traffic-Filters-Precedence-5695a5700ffabd8444951f3a32ddfaee.svg"}}]);