"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2478],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=u(n),m=o,h=d["".concat(s,".").concat(m)]||d[m]||p[m]||i;return n?r.createElement(h,a(a({ref:t},c),{},{components:n})):r.createElement(h,a({ref:t},c))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,a[1]=l;for(var u=2;u<i;u++)a[u]=n[u];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4982:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return l},metadata:function(){return u},toc:function(){return p}});var r=n(3117),o=n(102),i=(n(7294),n(3905)),a=["components"],l={},s="Web A6 - Log4J Remote Code Execution",u={unversionedId:"OWASP-WEB-10/A6-Vulnerable-Components/A6-Log4J-RCE",id:"version-v1/OWASP-WEB-10/A6-Vulnerable-Components/A6-Log4J-RCE",title:"Web A6 - Log4J Remote Code Execution",description:"LOG4J",source:"@site/vulnerabilities_versioned_docs/version-v1/OWASP-WEB-10/A6-Vulnerable-Components/A6-Log4J-RCE.md",sourceDirName:"OWASP-WEB-10/A6-Vulnerable-Components",slug:"/OWASP-WEB-10/A6-Vulnerable-Components/A6-Log4J-RCE",permalink:"/vulnerabilities/v1/OWASP-WEB-10/A6-Vulnerable-Components/A6-Log4J-RCE",draft:!1,tags:[],version:"v1",frontMatter:{},sidebar:"version-v1/tutorialSidebar",previous:{title:"API Security | Addressing OWASP A6 Vulnerabilities",permalink:"/vulnerabilities/v1/OWASP-WEB-10/A6-Vulnerable-Components/A6-index"},next:{title:"Web A10 - Server Side Request Forgery",permalink:"/vulnerabilities/v1/OWASP-WEB-10/A10-SSRF"}},c={},p=[{value:"What is it?",id:"what-is-it",level:2},{value:"References",id:"references",level:2},{value:"Test case FAQs",id:"test-case-faqs",level:2},{value:"When is this test case applicable?",id:"when-is-this-test-case-applicable",level:3},{value:"How does it work?",id:"how-does-it-work",level:3},{value:"What is the solution?",id:"what-is-the-solution",level:3}],d={toc:p};function m(e){var t=e.components,l=(0,o.Z)(e,a);return(0,i.kt)("wrapper",(0,r.Z)({},d,l,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"web-a6---log4j-remote-code-execution"},"Web A6 - Log4J Remote Code Execution"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"LOG4J",src:n(6243).Z,width:"890",height:"705"})),(0,i.kt)("h2",{id:"what-is-it"},"What is it?"),(0,i.kt)("p",null,"This vulnerability arises due to high level reasons listed ",(0,i.kt)("a",{parentName:"p",href:"/vulnerabilities/v1/OWASP-WEB-10/A6-Vulnerable-Components/A6-index"},"here"),"."),(0,i.kt)("p",null,"Log4J is a widely used java based logging library. It has a known vulnerability that allows an attacker to download malicious code into the Log4J component, which leads to remote code execution."),(0,i.kt)("p",null,"The exact steps of this attack is described in the diagram above."),(0,i.kt)("h2",{id:"references"},"References"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://cwe.mitre.org/data/definitions/117.html"},"CWE-117: Improper Output Neutralization for Logs")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://logging.apache.org/log4j/2.x/security.html"},"Log4J Security Vulnerbilities")),(0,i.kt)("h2",{id:"test-case-faqs"},"Test case FAQs"),(0,i.kt)("h3",{id:"when-is-this-test-case-applicable"},"When is this test case applicable?"),(0,i.kt)("p",null,"Applies to all API endpoints that consume user supplied input."),(0,i.kt)("h3",{id:"how-does-it-work"},"How does it work?"),(0,i.kt)("p",null,"The input parameter(s) within the API endpoint, are injected with malicious strings (Log4J injection strings. See diagram above)."),(0,i.kt)("p",null,"This malicious string refers to a remote server controlled by Levo. This remote server is called the ",(0,i.kt)("inlineCode",{parentName:"p"},"remote responder"),"."),(0,i.kt)("p",null,"If this malicious string is logged via a vulnerable Log4J library, the library is tricked into contacting the remote responder controlled by Levo. "),(0,i.kt)("p",null,"Levo's remote responder provides confirmation that the attack launched by the test case was successful."),(0,i.kt)("h3",{id:"what-is-the-solution"},"What is the solution?"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Upgrade Log4j2 to version 2.15.0 or newer. ")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'In previous releases (>2.10) this behavior can be mitigated by setting the system property "log4j2.formatMsgNoLookups" to "true", or by removing the JndiLookup class from the classpath (example: zip -q -d log4j-core-*.jar org/apache/logging/log4j/core/lookup/JndiLookup.class).')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Whitelist outbound traffic from your services to only legitimate destinations (URLs)."))))}m.isMDXComponent=!0},6243:function(e,t,n){t.Z=n.p+"assets/images/A6-Log4J-RCE-9e48f2e59504f56a84f3a65c18ddf74a.svg"}}]);