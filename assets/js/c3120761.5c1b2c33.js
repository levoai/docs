"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6565],{3905:function(e,t,n){n.d(t,{Zo:function(){return l},kt:function(){return f}});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var u=r.createContext({}),c=function(e){var t=r.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},l=function(e){var t=c(e.components);return r.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,u=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),h=c(n),f=i,d=h["".concat(u,".").concat(f)]||h[f]||p[f]||o;return n?r.createElement(d,a(a({ref:t},l),{},{components:n})):r.createElement(d,a({ref:t},l))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=h;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var c=2;c<o;c++)a[c]=n[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},6144:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return u},default:function(){return f},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return p}});var r=n(3117),i=n(102),o=(n(7294),n(3905)),a=["components"],s={sidebar_position:4},u="Providing Authorization Information for `Horizontal Authorization Abuse` Test Cases",c={unversionedId:"security-contract-testing/tasks/authentication/horizontal-authz",id:"security-contract-testing/tasks/authentication/horizontal-authz",title:"Providing Authorization Information for `Horizontal Authorization Abuse` Test Cases",description:"Testing for Horizontal Authorization Abuse, requires credentials for additional users.",source:"@site/docs/security-contract-testing/tasks/authentication/horizontal-authz.md",sourceDirName:"security-contract-testing/tasks/authentication",slug:"/security-contract-testing/tasks/authentication/horizontal-authz",permalink:"/security-contract-testing/tasks/authentication/horizontal-authz",draft:!1,editUrl:"https://github.com/levoai/docs/edit/main/docs/security-contract-testing/tasks/authentication/horizontal-authz.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Providing Authorization Information for Authorization Abuse Tests",permalink:"/security-contract-testing/tasks/authentication/authz"},next:{title:"Providing Authorization Information for `Vertical Authorization Abuse` Test Cases",permalink:"/security-contract-testing/tasks/authentication/vertical-authz"}},l={},p=[],h={toc:p};function f(e){var t=e.components,n=(0,i.Z)(e,a);return(0,o.kt)("wrapper",(0,r.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"providing-authorization-information-for-horizontal-authorization-abuse-test-cases"},"Providing Authorization Information for ",(0,o.kt)("inlineCode",{parentName:"h1"},"Horizontal Authorization Abuse")," Test Cases"),(0,o.kt)("p",null,"Testing for ",(0,o.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Privilege_escalation#Horizontal"},(0,o.kt)("inlineCode",{parentName:"a"},"Horizontal Authorization Abuse")),", requires credentials for additional users."),(0,o.kt)("p",null,"Since horizontal authorization abuse (",(0,o.kt)("a",{parentName:"p",href:"/vulnerabilities/v1/OWASP-API-10/A1-BOLA"},"BOLA"),") is about violating resource ownership constraints among users, these tests operate with a notion of users owning specific RESTful resources."),(0,o.kt)("p",null,"The tests first access the API's RESTful resource via the user who owns the resource, and then attempt to do the same with an additional user, who does not have resource ownership."),(0,o.kt)("p",null,"The autogenerated ",(0,o.kt)("inlineCode",{parentName:"p"},"environment.yml")," file will have the below structure (assuming the default Bearer AuthN mechanism is being used)."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-YAML"},"# Environment file that contains users, roles and their Authentication\n# mechanisms that will be used by the API endpoints.\niam:\n  users:\n  - name: user_1\n    default: true # This user should own RESTful resources subject to horizontal abuse testing\n    bearer_tokens:\n    - name: bearerAuth\n      value: <Enter the bearer token>\n  - name: user_2\n    bearer_tokens:\n    - name: bearerAuth\n      value: <Enter the bearer token>\n")),(0,o.kt)("p",null,"You are required to provide valid ",(0,o.kt)("inlineCode",{parentName:"p"},"bearer tokens")," for two users above (",(0,o.kt)("inlineCode",{parentName:"p"},"user_1")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"user_2"),")."),(0,o.kt)("p",null,"If you are wondering why bearer tokens for two users are required, ",(0,o.kt)("inlineCode",{parentName:"p"},"user_1")," is the ",(0,o.kt)("inlineCode",{parentName:"p"},"default")," user, that is used in most of the API testing."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"user_2")," specifies credentials for another user (at the same role level as ",(0,o.kt)("inlineCode",{parentName:"p"},"user_1"),"), and is used in ",(0,o.kt)("a",{parentName:"p",href:"/vulnerabilities/v1/OWASP-API-10/A1-BOLA"},(0,o.kt)("inlineCode",{parentName:"a"},"horizontal privilege escalation"))," tests."),(0,o.kt)("p",null,"If using an authentication mechanism other than Bearer AuthN, please modify the auto generated YAML appropriately."))}f.isMDXComponent=!0}}]);