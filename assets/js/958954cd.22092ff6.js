"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6570],{3905:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return m}});var n=a(7294);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function r(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var s=n.createContext({}),c=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},u=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,i=e.originalType,s=e.parentName,u=r(e,["components","mdxType","originalType","parentName"]),d=c(a),m=l,h=d["".concat(s,".").concat(m)]||d[m]||p[m]||i;return a?n.createElement(h,o(o({ref:t},u),{},{components:a})):n.createElement(h,o({ref:t},u))}));function m(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var i=a.length,o=new Array(i);o[0]=d;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:l,o[1]=r;for(var c=2;c<i;c++)o[c]=a[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},1262:function(e,t,a){a.d(t,{Z:function(){return i}});var n=a(7294),l=a(2389);function i(e){var t=e.children,a=e.fallback;return(0,l.Z)()?n.createElement(n.Fragment,null,null==t?void 0:t()):null!=a?a:null}},398:function(e,t,a){a.r(t),a.d(t,{DockerComposeFile:function(){return m},assets:function(){return p},contentTitle:function(){return c},default:function(){return b},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return d}});var n=a(3117),l=a(102),i=(a(7294),a(3905)),o=a(1262),r=["components"],s={sidebar_position:1},c="Satellite Lifecycle Management",u={unversionedId:"api-observability/common-tasks/satellite/satellite-mgmt",id:"api-observability/common-tasks/satellite/satellite-mgmt",title:"Satellite Lifecycle Management",description:"1. Kubernetes based installation",source:"@site/docs/api-observability/common-tasks/satellite/satellite-mgmt.mdx",sourceDirName:"api-observability/common-tasks/satellite",slug:"/api-observability/common-tasks/satellite/satellite-mgmt",permalink:"/api-observability/common-tasks/satellite/satellite-mgmt",draft:!1,editUrl:"https://github.com/levoai/docs/edit/main/docs/api-observability/common-tasks/satellite/satellite-mgmt.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Kubernetes Configuration",permalink:"/api-observability/common-tasks/sensor/k8s-helm-values"},next:{title:"Troubleshooting",permalink:"/api-observability/common-tasks/satellite/troubleshoot"}},p={},d=[{value:"1. Kubernetes based installation",id:"1-kubernetes-based-installation",level:2},{value:"2. Docker based installation",id:"2-docker-based-installation",level:2},{value:"Kubernetes based installation",id:"kubernetes-based-installation",level:2},{value:"Upgrade Satellite",id:"upgrade-satellite",level:3},{value:"Uninstall Satellite",id:"uninstall-satellite",level:3},{value:"Change the <code>Authorization Key</code> used to communicate with Levo.ai",id:"change-the-authorization-key-used-to-communicate-with-levoai",level:3},{value:"Change the <code>minimum number of URLs</code> that the satellite needs to observe to detect an API endpoint.",id:"change-the-minimum-number-of-urls-that-the-satellite-needs-to-observe-to-detect-an-api-endpoint",level:3},{value:"List Satellite&#39;s pods",id:"list-satellites-pods",level:3},{value:"Tail logs of a specific pod",id:"tail-logs-of-a-specific-pod",level:3},{value:"Docker based installation",id:"docker-based-installation",level:2},{value:"Uninstall the Satellite",id:"uninstall-the-satellite",level:3},{value:"Upgrade the Satellite",id:"upgrade-the-satellite",level:3},{value:"Change the <code>minimum number of URLs</code> that the satellite needs to observe to detect an API endpoint.",id:"change-the-minimum-number-of-urls-that-the-satellite-needs-to-observe-to-detect-an-api-endpoint-1",level:3},{value:"List Satellite&#39;s containers",id:"list-satellites-containers",level:3},{value:"Get logs of a specific container",id:"get-logs-of-a-specific-container",level:3},{value:"Tail logs of a specific container",id:"tail-logs-of-a-specific-container",level:3},{value:"Get logs for last 1 minute",id:"get-logs-for-last-1-minute",level:3}];function m(){return(0,i.kt)(o.Z,{fallback:(0,i.kt)("div",null,"Loading..."),mdxType:"BrowserOnly"},(function(){return(0,i.kt)("a",{href:window.location.protocol+"//"+window.location.host+"/artifacts/satellite/docker-compose.yml",download:!0}," Docker Compose file")}))}var h={toc:d,DockerComposeFile:m};function b(e){var t=e.components,a=(0,l.Z)(e,r);return(0,i.kt)("wrapper",(0,n.Z)({},h,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"satellite-lifecycle-management"},"Satellite Lifecycle Management"),(0,i.kt)("h2",{id:"1-kubernetes-based-installation"},(0,i.kt)("a",{parentName:"h2",href:"/api-observability/common-tasks/satellite/satellite-mgmt#kubernetes-based-installation"},"1. Kubernetes based installation")),(0,i.kt)("h2",{id:"2-docker-based-installation"},(0,i.kt)("a",{parentName:"h2",href:"/api-observability/common-tasks/satellite/satellite-mgmt#docker-based-installation"},"2. Docker based installation")),(0,i.kt)("br",null),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"kubernetes-based-installation"},"Kubernetes based installation"),(0,i.kt)("h3",{id:"upgrade-satellite"},"Upgrade Satellite"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# Setup environment variables\nexport LEVOAI_AUTH_KEY=<'Authorization Key' from the original installation> \n\n# Update helm repo and upgrade installation\nhelm repo update\n\nhelm upgrade -n levoai \\\n  --set global.levoai_config_override.onprem-api.refresh-token=$LEVOAI_AUTH_KEY \\\n  levoai-satellite levoai/levoai-satellite\n")),(0,i.kt)("h3",{id:"uninstall-satellite"},"Uninstall Satellite"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"helm uninstall levoai-satellite -n levoai\n")),(0,i.kt)("p",null,"After running the above command, wait until all Satellite pods have been terminated, and then run the following command to delete the rabbitmq PersistentVolumeClaim. Deleting the PVC also deletes the corresponding PersistentVolume."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl delete pvc data-levoai-rabbitmq-0 -n levoai\n")),(0,i.kt)("p",null,"In case the ",(0,i.kt)("inlineCode",{parentName:"p"},"kubectl delete pvc")," command gets stuck, run the following command before deleting the PVC again:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},'kubectl patch pvc data-levoai-rabbitmq-0 -p \'{"metadata":{"finalizers":null}}\' -n levoai\n')),(0,i.kt)("h3",{id:"change-the-authorization-key-used-to-communicate-with-levoai"},"Change the ",(0,i.kt)("inlineCode",{parentName:"h3"},"Authorization Key")," used to communicate with Levo.ai"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Uninstall the Satellite."),(0,i.kt)("li",{parentName:"ul"},"Reinstall the Satellite with the new ",(0,i.kt)("inlineCode",{parentName:"li"},"Authorization Key"),".")),(0,i.kt)("h3",{id:"change-the-minimum-number-of-urls-that-the-satellite-needs-to-observe-to-detect-an-api-endpoint"},"Change the ",(0,i.kt)("inlineCode",{parentName:"h3"},"minimum number of URLs")," that the satellite needs to observe to detect an API endpoint."),(0,i.kt)("p",null,"To detect an API endpoint, Satellite waits for at least '10' URLs to match that endpoint URL pattern.\nThis number may cause delays in detecting API endpoints when there is not enough load."),(0,i.kt)("p",null,"If you want to change this number to suit your environment:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Export an environment variable ",(0,i.kt)("inlineCode",{parentName:"li"},"LEVOAI_MIN_URLS_PER_PATTERN"),", and"),(0,i.kt)("li",{parentName:"ul"},"Restart the Satellite with 'min_urls_required_per_pattern' helm config override option")),(0,i.kt)("p",null,"For example, to set this to 3:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# Setup environment variables\nexport LEVOAI_AUTH_KEY=<'Authorization Key' from the original installation>\nexport LEVOAI_MIN_URLS_PER_PATTERN=3\n\n# Update helm repo and upgrade installation\nhelm repo update\n\nhelm upgrade -n levoai \\\n  --set global.levoai_config_override.onprem-api.refresh-token=$LEVOAI_AUTH_KEY \\\n  --set global.levoai_config_override.min_urls_required_per_pattern=$LEVOAI_MIN_URLS_PER_PATTERN \\\n  levoai-satellite levoai/levoai-satellite\n")),(0,i.kt)("h3",{id:"list-satellites-pods"},"List Satellite's pods"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl -n levoai get pods | grep -E '^levoai-collector|^levoai-rabbitmq|^levoai-satellite|^levoai-tagger'\n")),(0,i.kt)("h3",{id:"tail-logs-of-a-specific-pod"},"Tail logs of a specific pod"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl -n levoai logs -f <pod name>\n")),(0,i.kt)("br",null),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"docker-based-installation"},"Docker based installation"),(0,i.kt)("h3",{id:"uninstall-the-satellite"},"Uninstall the Satellite"),(0,i.kt)("p",null,"Ensure you are in the same directory where you downloaded the ",(0,i.kt)(m,{mdxType:"DockerComposeFile"}),"."),(0,i.kt)("p",null,"Execute the below command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose down --remove-orphans -v\n")),(0,i.kt)("h3",{id:"upgrade-the-satellite"},"Upgrade the Satellite"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"#uninstall-the-satellite"},"Uninstall")," the Satellite"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"/api-observability/install-guide/install-satellite"},"Reinstall")," the Satellite. The install always ",(0,i.kt)("em",{parentName:"li"},"pulls")," the latest Docker images for the Satellite.")),(0,i.kt)("h3",{id:"change-the-minimum-number-of-urls-that-the-satellite-needs-to-observe-to-detect-an-api-endpoint-1"},"Change the ",(0,i.kt)("inlineCode",{parentName:"h3"},"minimum number of URLs")," that the satellite needs to observe to detect an API endpoint."),(0,i.kt)("p",null,"To detect an API endpoint, Satellite waits for at least '10' URLs to match that endpoint URL pattern.\nThis number may cause delays in detecting API endpoints when there is not enough load."),(0,i.kt)("p",null,"If you want to change this number to suit your environment:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"export the environment variable ",(0,i.kt)("inlineCode",{parentName:"p"},"LEVOAI_MIN_URLS_PER_PATTERN")," - for example :\n",(0,i.kt)("inlineCode",{parentName:"p"},"export LEVOAI_MIN_URLS_PER_PATTERN=3"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Reinstall the Satellite to pickup the new configuration"))),(0,i.kt)("h3",{id:"list-satellites-containers"},"List Satellite's containers"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"docker ps | grep -E 'levoai/collector|bitnami/rabbitmq|levoai/satellite|levoai/tagger'\n")),(0,i.kt)("h3",{id:"get-logs-of-a-specific-container"},"Get logs of a specific container"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"docker logs <container id>\n")),(0,i.kt)("h3",{id:"tail-logs-of-a-specific-container"},"Tail logs of a specific container"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"docker logs -f <container id>\n")),(0,i.kt)("h3",{id:"get-logs-for-last-1-minute"},"Get logs for last 1 minute"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"docker logs <container id> --since 1m\n")))}b.isMDXComponent=!0}}]);