"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8125],{3905:function(e,t,l){l.d(t,{Zo:function(){return u},kt:function(){return h}});var a=l(7294);function i(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}function n(e,t){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),l.push.apply(l,a)}return l}function o(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?n(Object(l),!0).forEach((function(t){i(e,t,l[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):n(Object(l)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))}))}return e}function r(e,t){if(null==e)return{};var l,a,i=function(e,t){if(null==e)return{};var l,a,i={},n=Object.keys(e);for(a=0;a<n.length;a++)l=n[a],t.indexOf(l)>=0||(i[l]=e[l]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)l=n[a],t.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(e,l)&&(i[l]=e[l])}return i}var s=a.createContext({}),c=function(e){var t=a.useContext(s),l=t;return e&&(l="function"==typeof e?e(t):o(o({},t),e)),l},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var l=e.components,i=e.mdxType,n=e.originalType,s=e.parentName,u=r(e,["components","mdxType","originalType","parentName"]),d=c(l),h=i,m=d["".concat(s,".").concat(h)]||d[h]||p[h]||n;return l?a.createElement(m,o(o({ref:t},u),{},{components:l})):a.createElement(m,o({ref:t},u))}));function h(e,t){var l=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var n=l.length,o=new Array(n);o[0]=d;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:i,o[1]=r;for(var c=2;c<n;c++)o[c]=l[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,l)}d.displayName="MDXCreateElement"},9815:function(e,t,l){l.r(t),l.d(t,{assets:function(){return u},contentTitle:function(){return s},default:function(){return h},frontMatter:function(){return r},metadata:function(){return c},toc:function(){return p}});var a=l(3117),i=l(102),n=(l(7294),l(3905)),o=["components"],r={sidebar_position:3},s="Install Satellite",c={unversionedId:"beta/api-observability/install-guide/install-satellite",id:"beta/api-observability/install-guide/install-satellite",title:"Install Satellite",description:"1. Prerequisites",source:"@site/docs/beta/api-observability/install-guide/install-satellite.md",sourceDirName:"beta/api-observability/install-guide",slug:"/beta/api-observability/install-guide/install-satellite",permalink:"/beta/api-observability/install-guide/install-satellite",editUrl:"https://github.com/levoai/docs/edit/main/docs/beta/api-observability/install-guide/install-satellite.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Compatibility Check",permalink:"/beta/api-observability/install-guide/os-compat-check"},next:{title:"Install Sensor",permalink:"/beta/api-observability/install-guide/install-sensor"}},u={},p=[{value:"1. Prerequisites",id:"1-prerequisites",level:2},{value:"2. Planning",id:"2-planning",level:2},{value:"a. Placement of the Satellite",id:"a-placement-of-the-satellite",level:3},{value:"b. Copy <code>Authorization Key</code> from Levo.ai",id:"b-copy-authorization-key-from-levoai",level:3},{value:"3. Follow instructions for your platform",id:"3-follow-instructions-for-your-platform",level:2},{value:"Install on Kubernetes",id:"install-on-kubernetes",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"1. Setup environment variables",id:"1-setup-environment-variables",level:3},{value:"2. Install levoai Helm repo",id:"2-install-levoai-helm-repo",level:3},{value:"3. Create <code>levoai</code> namespace &amp; install Satellite",id:"3-create-levoai-namespace--install-satellite",level:3},{value:"If locating Satellite on the same cluster alongside Sensor",id:"if-locating-satellite-on-the-same-cluster-alongside-sensor",level:4},{value:"If locating Satellite on a dedicated cluster",id:"if-locating-satellite-on-a-dedicated-cluster",level:4},{value:"4. Verify connectivity with Levo.ai",id:"4-verify-connectivity-with-levoai",level:3},{value:"a. Check Satellite health",id:"a-check-satellite-health",level:4},{value:"b. Check connectivity",id:"b-check-connectivity",level:4},{value:"5. Note down <code>Host:Port</code> information",id:"5-note-down-hostport-information",level:3},{value:"If locating Satellite on the same cluster alongside Sensor",id:"if-locating-satellite-on-the-same-cluster-alongside-sensor-1",level:4},{value:"If locating Satellite on a dedicated cluster",id:"if-locating-satellite-on-a-dedicated-cluster-1",level:4},{value:"Install on Linux host via Docker Compose",id:"install-on-linux-host-via-docker-compose",level:2},{value:"Prerequisites",id:"prerequisites-1",level:3},{value:"1. Download Docker Compose file",id:"1-download-docker-compose-file",level:3},{value:"2. Install Satellite",id:"2-install-satellite",level:3},{value:"3. Verify connectivity with Levo.ai",id:"3-verify-connectivity-with-levoai",level:3},{value:"a. Check Satellite health",id:"a-check-satellite-health-1",level:4},{value:"b. Check connectivity",id:"b-check-connectivity-1",level:4},{value:"4. Note down <code>Host:Port</code> information",id:"4-note-down-hostport-information",level:3}],d={toc:p};function h(e){var t=e.components,r=(0,i.Z)(e,o);return(0,n.kt)("wrapper",(0,a.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"install-satellite"},"Install Satellite"),(0,n.kt)("h2",{id:"1-prerequisites"},"1. Prerequisites"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"You have an account on ",(0,n.kt)("a",{parentName:"li",href:"https://app.levo.ai/login"},"Levo.ai")),(0,n.kt)("li",{parentName:"ul"},"Compatibility script (from step 1) indicates the Linux host (that you want to instrument) is compatible.")),(0,n.kt)("h2",{id:"2-planning"},"2. Planning"),(0,n.kt)("h3",{id:"a-placement-of-the-satellite"},"a. Placement of the Satellite"),(0,n.kt)("p",null,"There are two options for the Satellite placement. Chose what best works for you."),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Placement Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Pros"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Cons"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Same Host/Cluster as Sensor"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("ul",null,(0,n.kt)("li",null," Simpler installation.")," ",(0,n.kt)("li",null,"Easy to get started."))),(0,n.kt)("td",{parentName:"tr",align:"left"},"Satellite consumes resources on the host/cluster where your application workloads are located. ",(0,n.kt)("br",null)," This might lead to resource contention based on traffic load.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Dedicated Host/Cluster"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("ul",null,(0,n.kt)("li",null," Eliminates any resource contention issues with your application workloads.")," ",(0,n.kt)("li",null," The Satellite can service traffic from multiple hosts/clusters that are instrumented."))),(0,n.kt)("td",{parentName:"tr",align:"left"},"Requires a dedicated host/cluster.")))),(0,n.kt)("h3",{id:"b-copy-authorization-key-from-levoai"},"b. Copy ",(0,n.kt)("inlineCode",{parentName:"h3"},"Authorization Key")," from Levo.ai"),(0,n.kt)("p",null,"The Satellite uses an authorization key to access Levo.ai. Follow instructions below to copy the key."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://app.levo.ai/login"},"Login")," to Levo.ai."),(0,n.kt)("li",{parentName:"ul"},"Click on your user profile."),(0,n.kt)("li",{parentName:"ul"},"Click on ",(0,n.kt)("inlineCode",{parentName:"li"},"User Settings")),(0,n.kt)("li",{parentName:"ul"},"Click on ",(0,n.kt)("inlineCode",{parentName:"li"},"Keys")," on the left navigation panel"),(0,n.kt)("li",{parentName:"ul"},"Click on ",(0,n.kt)("inlineCode",{parentName:"li"},"Get Satellite Authorization Key")),(0,n.kt)("li",{parentName:"ul"},"Now copy your authorization key. This key is required in a subsequent step below.")),(0,n.kt)("h2",{id:"3-follow-instructions-for-your-platform"},"3. Follow instructions for your platform"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/beta/api-observability/install-guide/install-satellite#install-on-kubernetes"},"Install on Kubernetes")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/beta/api-observability/install-guide/install-satellite#install-on-linux-host-via-docker-compose"},"Install on Linux host via Docker Compose"))),(0,n.kt)("br",null),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"install-on-kubernetes"},"Install on Kubernetes"),(0,n.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Kubernetes version >= ",(0,n.kt)("inlineCode",{parentName:"li"},"v1.18.0")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://helm.sh/docs/intro/install/"},"Helm v3")," installed and working."),(0,n.kt)("li",{parentName:"ul"},"The Kubernetes cluster API endpoint should be reachable from the machine you are running Helm."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"kubectl")," access to the cluster, with ",(0,n.kt)("inlineCode",{parentName:"li"},"cluster-admin")," permissions.")),(0,n.kt)("h3",{id:"1-setup-environment-variables"},"1. Setup environment variables"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"export LEVOAI_AUTH_KEY=<'Authorization Key' copied earlier> \n")),(0,n.kt)("h3",{id:"2-install-levoai-helm-repo"},"2. Install levoai Helm repo"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"helm repo add levoai https://charts.levo.ai && helm repo update\n")),(0,n.kt)("h3",{id:"3-create-levoai-namespace--install-satellite"},"3. Create ",(0,n.kt)("inlineCode",{parentName:"h3"},"levoai")," namespace & install Satellite"),(0,n.kt)("h4",{id:"if-locating-satellite-on-the-same-cluster-alongside-sensor"},"If locating Satellite on the same cluster alongside Sensor"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"helm install -n levoai --create-namespace \\\n    --set global.levoai_config_override.onprem-api.refresh-token=$LEVOAI_AUTH_KEY \\\n    levoai-satellite levoai/levoai-satellite\n")),(0,n.kt)("h4",{id:"if-locating-satellite-on-a-dedicated-cluster"},"If locating Satellite on a dedicated cluster"),(0,n.kt)("p",null,"You will need to expose the Satellite via either a ",(0,n.kt)("inlineCode",{parentName:"p"},"LoadBalancer")," or ",(0,n.kt)("inlineCode",{parentName:"p"},"NodePort"),", such that is is reachable by Sensors running in other clusters. Please modify the below command appropriately."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"# Please modify this command template and choose either 'LoadBalancer' or 'NodePort', prior to execution\nhelm install -n levoai --create-namespace \\\n    --set global.levoai_config_override.onprem-api.refresh-token=$LEVOAI_AUTH_KEY \\\n    --set levoai-collector.service.type=<LoadBalancer | NodePort> \\\n    levoai-satellite levoai/levoai-satellite\n")),(0,n.kt)("h3",{id:"4-verify-connectivity-with-levoai"},"4. Verify connectivity with Levo.ai"),(0,n.kt)("h4",{id:"a-check-satellite-health"},"a. Check Satellite health"),(0,n.kt)("p",null,"The Satellite is comprised of four sub components 1) levoai-collector, 2) levoai-rabbitmq, 3)levoai-satellite, and 4) levoai-tagger."),(0,n.kt)("p",null,"Wait couple of minutes after the install, and check the health of the components by executing the following:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl -n levoai get pods\n")),(0,n.kt)("p",null,"If the Satellite is healthy, you should see output similar to below. Don't worry about the restarts of the levoai-tagger pod."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"NAME                                READY   STATUS    RESTARTS      AGE\nlevoai-collector-848fb4fff9-gv8g9   1/1     Running   0             4m8s\nlevoai-rabbitmq-0                   1/1     Running   0             4m8s\nlevoai-satellite-54956ccb89-5s4h2   1/1     Running   0             4m8s\nlevoai-tagger-799db4d9cc-89jm8      1/1     Running   3 (4m8s ago)  4m8s\n")),(0,n.kt)("h4",{id:"b-check-connectivity"},"b. Check connectivity"),(0,n.kt)("p",null,"Execute the following to check for connectivity health:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'# Please specify the actual pod name for levoai-tagger below\nkubectl -n levoai logs <levoai-tagger pod name> | grep "Ready to process; waiting for messages."\n')),(0,n.kt)("p",null,"If connectivity is healthy, you will see output similar to below."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'{"level": "info", "time": "2022-06-07 08:07:22,439", "line": "rabbitmq_client.py:155", "version": "fc628b50354bf94e544eef46751d44945a2c55bc", "module": "/opt/levoai/e7s/src/python/levoai_e7s/satellite/rabbitmq_client.py", "message": "Ready to process; waiting for messages."}\n')),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Please contact ",(0,n.kt)("inlineCode",{parentName:"strong"},"support@levo.ai")," if you notice health/connectivity related errors.")),(0,n.kt)("h3",{id:"5-note-down-hostport-information"},"5. Note down ",(0,n.kt)("inlineCode",{parentName:"h3"},"Host:Port")," information"),(0,n.kt)("h4",{id:"if-locating-satellite-on-the-same-cluster-alongside-sensor-1"},"If locating Satellite on the same cluster alongside Sensor"),(0,n.kt)("p",null,"The Collector can now be reached by the Sensors running in the same cluster at ",(0,n.kt)("inlineCode",{parentName:"p"},"levoai-collector.levoai:4317"),". Please note this, as it will be required to configure the Sensor."),(0,n.kt)("h4",{id:"if-locating-satellite-on-a-dedicated-cluster-1"},"If locating Satellite on a dedicated cluster"),(0,n.kt)("p",null,"Run the below command and note the ",(0,n.kt)("inlineCode",{parentName:"p"},"external")," address/port of the the Collector service. This will be required to configure the Sensor."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get service levoai-collector -n levoai\n")),(0,n.kt)("p",null,"Please proceed to install the Sensor."),(0,n.kt)("br",null),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"install-on-linux-host-via-docker-compose"},"Install on Linux host via Docker Compose"),(0,n.kt)("h3",{id:"prerequisites-1"},"Prerequisites"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Docker version ",(0,n.kt)("inlineCode",{parentName:"li"},"18.03.0")," and above"),(0,n.kt)("li",{parentName:"ul"},"Admin privileges on the Docker host")),(0,n.kt)("h3",{id:"1-download-docker-compose-file"},"1. Download Docker Compose file"),(0,n.kt)("p",null,"Levo provides pre-built Docker images for the Satellite that can be installed via Docker Compose.\n",(0,n.kt)("a",{target:"_blank",href:l(1894).Z},"Download")," the Docker Compose file to your desktop."),(0,n.kt)("h3",{id:"2-install-satellite"},"2. Install Satellite"),(0,n.kt)("p",null,"Execute the following from the directory where the Docker Compose file was downloaded."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"(export LEVOAI_AUTH_KEY=<'Authorization Key' copied earlier>; docker compose pull && docker compose up -d)\n")),(0,n.kt)("h3",{id:"3-verify-connectivity-with-levoai"},"3. Verify connectivity with Levo.ai"),(0,n.kt)("h4",{id:"a-check-satellite-health-1"},"a. Check Satellite health"),(0,n.kt)("p",null,"The Satellite is comprised of four sub components 1) levoai-collector, 2) levoai-rabbitmq, 3)levoai-satellite, and 4) levoai-tagger."),(0,n.kt)("p",null,"Wait couple of minutes after the install, and check the health of the components by executing the following:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"docker ps -f name=levoai\n")),(0,n.kt)("p",null,"If the Satellite is healthy, you should see output similar to below."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'CONTAINER ID   IMAGE                     COMMAND                  CREATED             STATUS                  PORTS                                                                                                                                    NAMES\n2b32cd6b9ced   levoai/collector:stable   "/usr/local/bin/levo\u2026"   10 seconds ago      Up 8 seconds            0.0.0.0:4317->4317/tcp, 9411/tcp                                                                                                         levoai-collector\n06f3c597cad0   levoai/satellite:stable   "gunicorn --capture-\u2026"   10 seconds ago      Up 9 seconds            0.0.0.0:9999->9999/tcp                                                                                                                   levoai-satellite\n89026034c567   levoai/satellite:stable   "python -OO /opt/lev\u2026"   10 seconds ago      Up Less than a second                                                                                                                                            levoai-tagger\nf74524d02fbd   bitnami/rabbitmq:3.10     "/opt/bitnami/script\u2026"   10 seconds ago      Up 9 seconds            5551-5552/tcp, 0.0.0.0:4369->4369/tcp, 5671/tcp, 0.0.0.0:5672->5672/tcp, 0.0.0.0:15672->15672/tcp, 0.0.0.0:25672->25672/tcp, 15671/tcp   levoai-rabbitmq\n')),(0,n.kt)("h4",{id:"b-check-connectivity-1"},"b. Check connectivity"),(0,n.kt)("p",null,"Execute the following to check for connectivity health:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'docker logs levoai-tagger | grep "Ready to process; waiting for messages." \n')),(0,n.kt)("p",null,"If connectivity is healthy, you will see output similar to below."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'{"level": "info", "time": "2022-06-07 08:07:22,439", "line": "rabbitmq_client.py:155", "version": "fc628b50354bf94e544eef46751d44945a2c55bc", "module": "/opt/levoai/e7s/src/python/levoai_e7s/satellite/rabbitmq_client.py", "message": "Ready to process; waiting for messages."}\n')),(0,n.kt)("h3",{id:"4-note-down-hostport-information"},"4. Note down ",(0,n.kt)("inlineCode",{parentName:"h3"},"Host:Port")," information"),(0,n.kt)("p",null,"The Collector now runs in a container, and is reachable on the host via port 4317 (on all the host's network interfaces)."),(0,n.kt)("p",null,"Please note down the either the host's IP address or domain name. The Sensor will be configured to communicate with the Collector at <Host's IP|Domain-Name>:4317."),(0,n.kt)("p",null,"Please proceed to install the Sensor."))}h.isMDXComponent=!0},1894:function(e,t,l){t.Z=l.p+"assets/files/docker-compose-7be994463518220c74883399f051b177.yml"}}]);