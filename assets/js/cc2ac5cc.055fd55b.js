"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[775],{3905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return d}});var i=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},a=Object.keys(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=i.createContext({}),c=function(e){var t=i.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},u=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},h=i.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),h=c(r),d=n,f=h["".concat(l,".").concat(d)]||h[d]||p[d]||a;return r?i.createElement(f,s(s({ref:t},u),{},{components:r})):i.createElement(f,s({ref:t},u))}));function d(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,s=new Array(a);s[0]=h;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:n,s[1]=o;for(var c=2;c<a;c++)s[c]=r[c];return i.createElement.apply(null,s)}return i.createElement.apply(null,r)}h.displayName="MDXCreateElement"},3534:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return o},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return u},default:function(){return h}});var i=r(7462),n=r(3366),a=(r(7294),r(3905)),s=["components"],o={},l="Broken Object Level Authorization (aka IDOR)",c={unversionedId:"issues/vulnerabilities/IDOR",id:"issues/vulnerabilities/IDOR",isDocsHomePage:!1,title:"Broken Object Level Authorization (aka IDOR)",description:"IDOR / BOLA",source:"@site/docs/issues/vulnerabilities/IDOR.md",sourceDirName:"issues/vulnerabilities",slug:"/issues/vulnerabilities/IDOR",permalink:"/issues/vulnerabilities/IDOR",editUrl:"https://github.com/levoai/docs/edit/main/docs/issues/vulnerabilities/IDOR.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Levo Vulnerability Guide",permalink:"/issues/vulnerability-guide"},next:{title:"Server Side Request Forgery (SSRF)",permalink:"/issues/vulnerabilities/SSRF"}},u=[{value:"What is it?",id:"what-is-it",children:[],level:2},{value:"References",id:"references",children:[],level:2},{value:"Test case FAQs",id:"test-case-faqs",children:[{value:"When is this test case applicable?",id:"when-is-this-test-case-applicable",children:[],level:3}],level:2},{value:"How does it work?",id:"how-does-it-work",children:[],level:2},{value:"What is the solution?",id:"what-is-the-solution",children:[],level:2},{value:"False positives",id:"false-positives",children:[],level:2}],p={toc:u};function h(e){var t=e.components,o=(0,n.Z)(e,s);return(0,a.kt)("wrapper",(0,i.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"broken-object-level-authorization-aka-idor"},"Broken Object Level Authorization (aka IDOR)"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"IDOR / BOLA",src:r(1065).Z})),(0,a.kt)("h2",{id:"what-is-it"},"What is it?"),(0,a.kt)("p",null,"Attackers substitute the ID of their own resource in the API call with an ID of a resource belonging to another user. The lack of proper authorization checks allows attackers to access the specified resource. This attack is also known as IDOR (Insecure Direct Object Reference)."),(0,a.kt)("p",null,"In the above example Troy (who is an authenticated user) is able to access Scott's receipt! This is a serious vulnerability, that is a result of improper authorization checks at the ",(0,a.kt)("inlineCode",{parentName:"p"},"GET /receipts/{receipt_id}")," API endpoint."),(0,a.kt)("h2",{id:"references"},"References"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://owasp.org/www-project-api-security/"},"OWASP API TOP-10 #1"),(0,a.kt)("br",{parentName:"p"}),"\n",(0,a.kt)("a",{parentName:"p",href:"https://apisecurity.io/encyclopedia/content/owasp/api1-broken-object-level-authorization"},"BOLA / IDOR in API Security Encyclopedia")),(0,a.kt)("h2",{id:"test-case-faqs"},"Test case FAQs"),(0,a.kt)("h3",{id:"when-is-this-test-case-applicable"},"When is this test case applicable?"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Only for API endpoints that require authentication"),(0,a.kt)("li",{parentName:"ul"},"API endpoints that take one or more object/resource ids as an input via query or path params"),(0,a.kt)("li",{parentName:"ul"},"Currently only for non state changing operations like ",(0,a.kt)("inlineCode",{parentName:"li"},"GET"),". Coverage for state changing operations (POST, PUT, DELETE, etc.) will follow soon. ")),(0,a.kt)("h2",{id:"how-does-it-work"},"How does it work?"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Expects authentication details of two different users, ",(0,a.kt)("inlineCode",{parentName:"li"},"victim")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"attacker"),", to be configured via fixtures."),(0,a.kt)("li",{parentName:"ol"},"Expects all other endpoint params (query or path params) to be configured via fixtures."),(0,a.kt)("li",{parentName:"ol"},"Sends a request using victim's credentials, and stores the response."),(0,a.kt)("li",{parentName:"ol"},"Sends the exact request from the previous step, but with the ",(0,a.kt)("inlineCode",{parentName:"li"},"attacker's")," credentials. "),(0,a.kt)("li",{parentName:"ol"},"The two responses from the above two requests are compared"),(0,a.kt)("li",{parentName:"ol"},"If the ",(0,a.kt)("strong",{parentName:"li"},"comparison is a match"),", this is raised as an IDOR/BOLA vulnerability")),(0,a.kt)("h2",{id:"what-is-the-solution"},"What is the solution?"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Implement granular authorization checks, that tests for proper ownership of the requested resource(s) by the user making the request."),(0,a.kt)("li",{parentName:"ul"},"Authorize every request made by the user."),(0,a.kt)("li",{parentName:"ul"},"Do not rely on resource IDs that the client sends. Use IDs stored in the session object instead."),(0,a.kt)("li",{parentName:"ul"},"Use random resource IDs that cannot be guessed (",(0,a.kt)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/Universally_unique_identifier"},"UUIDs"),").")),(0,a.kt)("h2",{id:"false-positives"},"False positives"),(0,a.kt)("p",null,"The test case will generate a false positive, if the endpoint requires authentication and is designed to serve same object/resource for two different users. "),(0,a.kt)("p",null,"This could happen with with endpoints that server blog posts etc. In such cases you can disable the test case from executing, in the test plan."))}h.isMDXComponent=!0},1065:function(e,t,r){t.Z=r.p+"assets/images/IDOR-cb815eab80b7a14b9b47ab9a08ece415.svg"}}]);