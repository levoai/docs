"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1806],{3905:function(e,t,i){i.d(t,{Zo:function(){return u},kt:function(){return d}});var r=i(7294);function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)i=a[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)i=a[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var l=r.createContext({}),c=function(e){var t=r.useContext(l),i=t;return e&&(i="function"==typeof e?e(t):o(o({},t),e)),i},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var i=e.components,n=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),h=c(i),d=n,f=h["".concat(l,".").concat(d)]||h[d]||p[d]||a;return i?r.createElement(f,o(o({ref:t},u),{},{components:i})):r.createElement(f,o({ref:t},u))}));function d(e,t){var i=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=i.length,o=new Array(a);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:n,o[1]=s;for(var c=2;c<a;c++)o[c]=i[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,i)}h.displayName="MDXCreateElement"},2819:function(e,t,i){i.r(t),i.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return p}});var r=i(3117),n=i(102),a=(i(7294),i(3905)),o=["components"],s={sidebar_position:1,description:"Understand OWASP API Security Top 10 - A1: BOLA with Levo.ai. Learn about Broken Object Level Authorization vulnerabilities and mitigation strategies.",title:"API A1 - Broken Object Level Authorization | Levo.ai"},l="API A1 - Broken Object Level Authorization",c={unversionedId:"OWASP-API-10/A1-BOLA",id:"version-v1/OWASP-API-10/A1-BOLA",title:"API A1 - Broken Object Level Authorization | Levo.ai",description:"Understand OWASP API Security Top 10 - A1: BOLA with Levo.ai. Learn about Broken Object Level Authorization vulnerabilities and mitigation strategies.",source:"@site/vulnerabilities_versioned_docs/version-v1/OWASP-API-10/A1-BOLA.md",sourceDirName:"OWASP-API-10",slug:"/OWASP-API-10/A1-BOLA",permalink:"/vulnerabilities/v1/OWASP-API-10/A1-BOLA",draft:!1,tags:[],version:"v1",sidebarPosition:1,frontMatter:{sidebar_position:1,description:"Understand OWASP API Security Top 10 - A1: BOLA with Levo.ai. Learn about Broken Object Level Authorization vulnerabilities and mitigation strategies.",title:"API A1 - Broken Object Level Authorization | Levo.ai"},sidebar:"version-v1/tutorialSidebar",previous:{title:"Security Vulnerability Guide",permalink:"/vulnerabilities/v1/guide"},next:{title:"API A2 - Broken Authentication",permalink:"/vulnerabilities/v1/OWASP-API-10/A2-BUA"}},u={},p=[{value:"What is it?",id:"what-is-it",level:2},{value:"References",id:"references",level:2},{value:"Test case FAQs",id:"test-case-faqs",level:2},{value:"When is this test case applicable?",id:"when-is-this-test-case-applicable",level:3},{value:"How does it work?",id:"how-does-it-work",level:3},{value:"What is the solution?",id:"what-is-the-solution",level:3},{value:"False positives",id:"false-positives",level:2}],h={toc:p};function d(e){var t=e.components,s=(0,n.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},h,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"api-a1---broken-object-level-authorization"},"API A1 - Broken Object Level Authorization"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"BOLA",src:i(7126).Z,width:"353",height:"234"})),(0,a.kt)("h2",{id:"what-is-it"},"What is it?"),(0,a.kt)("p",null,"Attackers substitute the ID of their own resource in the API call with an ID of a resource belonging to another user. The lack of proper authorization checks allows attackers to access the specified resource.\nThis attack is also known as Horizontal Authorization Bypass, and ",(0,a.kt)("a",{parentName:"p",href:"https://www.hackerone.com/company-news/rise-idor"},"IDOR")," (Insecure Direct Object Reference)."),(0,a.kt)("p",null,"In the above example Troy (who is an authenticated user) is able to access Scott's receipt! This is a serious vulnerability, that is a result of improper authorization checks at the ",(0,a.kt)("inlineCode",{parentName:"p"},"GET /receipts/{receipt_id}")," API endpoint."),(0,a.kt)("h2",{id:"references"},"References"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://owasp.org/www-project-api-security/"},"OWASP API TOP-10 A1"),(0,a.kt)("br",{parentName:"p"}),"\n",(0,a.kt)("a",{parentName:"p",href:"https://apisecurity.io/encyclopedia/content/owasp/api1-broken-object-level-authorization"},"BOLA / IDOR in API Security Encyclopedia")),(0,a.kt)("h2",{id:"test-case-faqs"},"Test case FAQs"),(0,a.kt)("h3",{id:"when-is-this-test-case-applicable"},"When is this test case applicable?"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Only for API endpoints that require authentication."),(0,a.kt)("li",{parentName:"ul"},"API endpoints that take one or more object/resource IDs as an input via query or path params."),(0,a.kt)("li",{parentName:"ul"},"Requires the use of fixtures to provide valid object/resource IDs, that the test case can access using two different users who have the same privileges."),(0,a.kt)("li",{parentName:"ul"},"Currently only for non state changing operations like ",(0,a.kt)("inlineCode",{parentName:"li"},"GET"),". Coverage for state changing operations (POST, PUT, DELETE, etc.) will follow soon.")),(0,a.kt)("h3",{id:"how-does-it-work"},"How does it work?"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Expects authentication credentials of two different users, ",(0,a.kt)("inlineCode",{parentName:"li"},"victim")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"attacker"),", to be configured via the environment file."),(0,a.kt)("li",{parentName:"ol"},"Expects all other endpoint params (query or path params) to be configured via fixtures."),(0,a.kt)("li",{parentName:"ol"},"Sends a request using victim's credentials, and stores the response."),(0,a.kt)("li",{parentName:"ol"},"Sends the exact request from the previous step, but with the ",(0,a.kt)("inlineCode",{parentName:"li"},"attacker's")," credentials. "),(0,a.kt)("li",{parentName:"ol"},"The two responses from the above two requests are compared"),(0,a.kt)("li",{parentName:"ol"},"If the ",(0,a.kt)("strong",{parentName:"li"},"comparison is a match"),", this is raised as an BOLA/IDOR vulnerability")),(0,a.kt)("h3",{id:"what-is-the-solution"},"What is the solution?"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Implement granular authorization checks, that tests for proper ownership of the requested resource(s) by the user making the request."),(0,a.kt)("li",{parentName:"ul"},"Authorize every request made by the user."),(0,a.kt)("li",{parentName:"ul"},"Do not rely on resource IDs that the client sends. Use IDs stored in the session object instead."),(0,a.kt)("li",{parentName:"ul"},"Use random resource IDs that cannot be guessed (",(0,a.kt)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/Universally_unique_identifier"},"UUIDs"),").")),(0,a.kt)("h2",{id:"false-positives"},"False positives"),(0,a.kt)("p",null,"The test case will generate a false positive, if the endpoint requires authentication and is designed to serve same object/resource for two different users. "),(0,a.kt)("p",null,"This could happen with with endpoints that server blog posts etc. In such cases you can disable the test case from executing, in the test plan."))}d.isMDXComponent=!0},7126:function(e,t,i){t.Z=i.p+"assets/images/A1-BOLA-cb815eab80b7a14b9b47ab9a08ece415.svg"}}]);