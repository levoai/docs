"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7730],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return d}});var a=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=a.createContext({}),u=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=u(e.components);return a.createElement(s.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=u(t),d=o,v=m["".concat(s,".").concat(d)]||m[d]||p[d]||r;return t?a.createElement(v,l(l({ref:n},c),{},{components:t})):a.createElement(v,l({ref:n},c))}));function d(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,l=new Array(r);l[0]=m;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var u=2;u<r;u++)l[u]=t[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},1262:function(e,n,t){t.d(n,{Z:function(){return r}});var a=t(7294),o=t(2389);function r(e){var n=e.children,t=e.fallback;return(0,o.Z)()?a.createElement(a.Fragment,null,null==n?void 0:n()):null!=t?t:null}},5162:function(e,n,t){t.d(n,{Z:function(){return l}});var a=t(7294),o=t(4334),r="tabItem_Ymn6";function l(e){var n=e.children,t=e.hidden,l=e.className;return a.createElement("div",{role:"tabpanel",className:(0,o.Z)(r,l),hidden:t},n)}},5488:function(e,n,t){t.d(n,{Z:function(){return d}});var a=t(3117),o=t(7294),r=t(4334),l=t(2389),i=t(7392),s=t(7094),u=t(2466),c="tabList__CuJ",p="tabItem_LNqP";function m(e){var n,t,l=e.lazy,m=e.block,d=e.defaultValue,v=e.values,f=e.groupId,h=e.className,E=o.Children.map(e.children,(function(e){if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),g=null!=v?v:E.map((function(e){var n=e.props;return{value:n.value,label:n.label,attributes:n.attributes}})),k=(0,i.l)(g,(function(e,n){return e.value===n.value}));if(k.length>0)throw new Error('Docusaurus error: Duplicate values "'+k.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var O=null===d?d:null!=(n=null!=d?d:null==(t=E.find((function(e){return e.props.default})))?void 0:t.props.value)?n:E[0].props.value;if(null!==O&&!g.some((function(e){return e.value===O})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+O+'" but none of its children has the corresponding value. Available values are: '+g.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var _=(0,s.U)(),b=_.tabGroupChoices,w=_.setTabGroupChoices,N=(0,o.useState)(O),y=N[0],A=N[1],S=[],T=(0,u.o5)().blockElementScrollPositionUntilNextRender;if(null!=f){var I=b[f];null!=I&&I!==y&&g.some((function(e){return e.value===I}))&&A(I)}var R=function(e){var n=e.currentTarget,t=S.indexOf(n),a=g[t].value;a!==y&&(T(n),A(a),null!=f&&w(f,String(a)))},L=function(e){var n,t=null;switch(e.key){case"ArrowRight":var a,o=S.indexOf(e.currentTarget)+1;t=null!=(a=S[o])?a:S[0];break;case"ArrowLeft":var r,l=S.indexOf(e.currentTarget)-1;t=null!=(r=S[l])?r:S[S.length-1]}null==(n=t)||n.focus()};return o.createElement("div",{className:(0,r.Z)("tabs-container",c)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":m},h)},g.map((function(e){var n=e.value,t=e.label,l=e.attributes;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:y===n?0:-1,"aria-selected":y===n,key:n,ref:function(e){return S.push(e)},onKeyDown:L,onFocus:R,onClick:R},l,{className:(0,r.Z)("tabs__item",p,null==l?void 0:l.className,{"tabs__item--active":y===n})}),null!=t?t:n)}))),l?(0,o.cloneElement)(E.filter((function(e){return e.props.value===y}))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},E.map((function(e,n){return(0,o.cloneElement)(e,{key:n,hidden:e.props.value!==y})}))))}function d(e){var n=(0,l.Z)();return o.createElement(m,(0,a.Z)({key:String(n)},e))}},4797:function(e,n,t){t.r(n),t.d(n,{DownloadMainTF:function(){return f},assets:function(){return d},contentTitle:function(){return p},default:function(){return E},frontMatter:function(){return c},metadata:function(){return m},toc:function(){return v}});var a=t(3117),o=t(102),r=(t(7294),t(3905)),l=t(1262),i=t(5488),s=t(5162),u=["components"],c={sidebar_position:6,description:"Set up Levo.ai Satellite on AWS ECS with our detailed guide. Ensure robust API security through comprehensive installation and deployment instructions."},p="Satellite on AWS ECS",m={unversionedId:"install-satellite/satellite-aws-ecs",id:"install-satellite/satellite-aws-ecs",title:"Satellite on AWS ECS",description:"Set up Levo.ai Satellite on AWS ECS with our detailed guide. Ensure robust API security through comprehensive installation and deployment instructions.",source:"@site/docs/install-satellite/satellite-aws-ecs.mdx",sourceDirName:"install-satellite",slug:"/install-satellite/satellite-aws-ecs",permalink:"/install-satellite/satellite-aws-ecs",draft:!1,editUrl:"https://github.com/levoai/docs/edit/main/docs/install-satellite/satellite-aws-ecs.mdx",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6,description:"Set up Levo.ai Satellite on AWS ECS with our detailed guide. Ensure robust API security through comprehensive installation and deployment instructions."},sidebar:"tutorialSidebar",previous:{title:"Satellite on AWS EKS using Fargate",permalink:"/install-satellite/satellite-aws-eks-fargate"},next:{title:"Satellite on Windows VM",permalink:"/install-satellite/satellite-windows"}},d={},v=[{value:"Prerequisites",id:"prerequisites",level:3},{value:"1. Creating a Task Definition",id:"1-creating-a-task-definition",level:3},{value:"2. Run the Satellite",id:"2-run-the-satellite",level:3},{value:"3. Note down <code>Host:Port</code> information",id:"3-note-down-hostport-information",level:3}];function f(){return(0,r.kt)(l.Z,{fallback:(0,r.kt)("div",null,"Loading..."),mdxType:"BrowserOnly"},(function(){return(0,r.kt)("a",{href:window.location.protocol+"//"+window.location.host+"/artifacts/satellite/main.tf",download:!0}," main.tf ")}))}var h={toc:v,DownloadMainTF:f};function E(e){var n=e.components,t=(0,o.Z)(e,u);return(0,r.kt)("wrapper",(0,a.Z)({},h,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"satellite-on-aws-ecs"},"Satellite on AWS ECS"),(0,r.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Access to AWS ECS."),(0,r.kt)("li",{parentName:"ul"},"Levo.ai Org ID. Follow instructions below to copy the org ID."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://app.levo.ai/login"},"Login")," to Levo.ai."),(0,r.kt)("li",{parentName:"ul"},"Click on your user profile."),(0,r.kt)("li",{parentName:"ul"},"Click on ",(0,r.kt)("inlineCode",{parentName:"li"},"User Settings")),(0,r.kt)("li",{parentName:"ul"},"Click on ",(0,r.kt)("inlineCode",{parentName:"li"},"Organizations")," on the left navigation panel"),(0,r.kt)("li",{parentName:"ul"},"Click on ",(0,r.kt)("inlineCode",{parentName:"li"},"Copy")," under ",(0,r.kt)("inlineCode",{parentName:"li"},"Organization ID")),(0,r.kt)("li",{parentName:"ul"},"An AWS Role with the policies - ",(0,r.kt)("strong",{parentName:"li"},"_")," to assign to the task.")),(0,r.kt)("h3",{id:"1-creating-a-task-definition"},"1. Creating a Task Definition"),(0,r.kt)(i.Z,{defaultValue:"console",values:[{label:"AWS Console",value:"console"},{label:"Terraform",value:"tf"}],groupId:"env",mdxType:"Tabs"},(0,r.kt)(s.Z,{value:"console",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Open the AWS ECS console and click on Task Definitions.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Under the Create Task Defintion on the top right, click on ",(0,r.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/ecs/v2/create-task-definition-with-json"},"Create New Task Definition with JSON"),"."))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"NOTE:")),"  Make sure you are in the right AWS region that you want to have your service in")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Use the following task definition.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'{\n    "family": "levoai-satellite",\n    "containerDefinitions": [\n{\n    "name": "levoai-satellite",\n    "image": "levoai/satellite",\n    "cpu": 0,\n    "portMappings": [\n{\n    "name": "levoai-satellite-9999-tcp",\n    "containerPort": 9999,\n    "hostPort": 9999,\n    "protocol": "tcp",\n    "appProtocol": "http"\n}\n    ],\n    "essential": true,\n    "command": [\n    "-w",\n    "1",\n    "-b",\n    "0.0.0.0:9999",\n    "--worker-class",\n    "gevent",\n    "--worker-connections",\n    "30",\n    "levoai_e7s.satellite.satellite:create_server()"\n    ],\n    "environment": [\n{\n    "name": "LEVOAI_DEBUG_SERVER_HOST",\n    "value": "host.docker.internal"\n},\n{\n    "name": "LEVOAI_ORG_ID",\n    "value": "899590a5-0cca-47f3-915d-31e8a0d2386a"\n},\n{\n    "name": "LEVOAI_MODE",\n    "value": "docker-compose"\n},\n{\n    "name": "LEVOAI_CONF_OVERRIDES",\n    "value": "value": "{\\"onprem-api\\": {\\"url\\": \\"${LEVOAI_BASE_URL}\\", \\"refresh-token\\": \\"${LEVOAI_AUTH_KEY}\\", \\"org-id\\": \\"${LEVOAI_ORG_ID:-}\\", \\"org-prefix\\": \\"${LEVOAI_ORG_PREFIX:-}\\"},\\"traces_queue\\": {\\"type\\": \\"sqs\\"}}"\n},\n{\n    "name": "LEVOAI_DEBUG_ENABLED",\n    "value": "false"\n},\n{\n    "name": "LEVOAI_AUTH_KEY",\n    "value": "INSERT YOUR LEVO.AI AUTH KEY HERE"\n},\n{\n    "name": "LEVOAI_BASE_URL",\n    "value": "https://api.levo.ai"\n},\n{\n    "name": "LEVOAI_LOG_LEVEL",\n    "value": "INFO"\n},\n{\n    "name": "LEVOAI_DEBUG_PORT",\n    "value": "12345"\n}\n    ],\n    "mountPoints": [],\n    "volumesFrom": [],\n    "logConfiguration": {\n    "logDriver": "awslogs",\n    "options": {\n    "awslogs-create-group": "true",\n    "awslogs-group": "/ecs/satellite",\n    "awslogs-region": "< INSERT YOUR AWS REGION HERE >",\n    "awslogs-stream-prefix": "ecs"\n}\n}\n},\n{\n    "name": "levoai-tagger",\n    "image": "levoai/satellite",\n    "cpu": 0,\n    "portMappings": [],\n    "essential": true,\n    "entryPoint": [\n    "python",\n    "-OO"\n    ],\n    "command": [\n    "/opt/levoai/e7s/src/python/levoai_e7s/tag_server.py"\n    ],\n    "environment": [\n{\n    "name": "LEVOAI_DEBUG_SERVER_HOST",\n    "value": "host.docker.internal"\n},\n{\n    "name": "LEVOAI_ORG_ID",\n    "value": "INSERT YOUR AWS REGION HERE",\n},\n{\n    "name": "LEVOAI_MODE",\n    "value": "docker-compose"\n},\n{\n    "name": "LEVOAI_CONF_OVERRIDES",\n    "value": "{\\"onprem-api\\":{\\"url\\": \\"${LEVOAI_BASE_URL}\\",\\"refresh-token\\":\\"${LEVOAI_AUTH_KEY}\\",\\"org-id\\": \\"${LEVOAI_ORG_ID}\\",\\"org-prefix\\": \\"${LEVOAI_ORG_PREFIX}\\"},\\"url_clusterer_id_len\\": 1,\\"min_urls_required_per_pattern\\": 10,\\"dynamic_url_threshold_factor\\": 0.5,\\"cookie_auth_keys\\": \\"${LEVOAI_COOKIE_AUTH_KEYS:-}\\",\\"disable_ml_detector\\": true,\\"service_naming\\":{\\"strategies\\": \\"KUBERNETES_METADATA,HOST_HEADER,DEFAULT\\"},\\"user_resolvers\\": [],\\"sample_collection\\":{\\"enabled\\": true,\\"max_samples_per_end_point\\": 2,\\"users\\": []},\\"tagger_batch_interval_minute\\": 5,\\"api_rule_evaluation\\":{\\"enabled\\": true},\\"ion\\":{\\"url\\": \\"http://levoai-ion:8000\\"},\\"enable_ssl_cert_checks\\": true,\\"sensitive_data_config\\": [],\\"traces_queue\\":{\\"type\\": \\"sqs\\"}}"\n},\n{\n    "name": "PI_DETECTOR_DATA_DIR",\n    "value": "/opt/levoai/datasets/"\n},\n{\n    "name": "LEVOAI_DEBUG_ENABLED",\n    "value": "false"\n},\n{\n    "name": "LEVOAI_AUTH_KEY",\n    "value": "INSERT YOUR LEVO.AI AUTH KEY HERE"\n},\n{\n    "name": "LEVOAI_BASE_URL",\n    "value": "https://api.levo.ai"\n},\n{\n    "name": "LEVOAI_LOG_LEVEL",\n    "value": "INFO"\n},\n{\n    "name": "LEVOAI_DEBUG_PORT",\n    "value": "1234"\n}\n    ],\n    "mountPoints": [],\n    "volumesFrom": [],\n    "logConfiguration": {\n    "logDriver": "awslogs",\n    "options": {\n    "awslogs-create-group": "true",\n    "awslogs-group": "/ecs/satellite",\n    "awslogs-region": "INSERT YOUR AWS REGION HERE",\n    "awslogs-stream-prefix": "ecs"\n}\n}\n},\n{\n    "name": "levoai-collector",\n    "image": "levoai/collector",\n    "cpu": 0,\n    "portMappings": [\n{\n    "name": "levoai-collector-4317-tcp",\n    "containerPort": 4317,\n    "hostPort": 4317,\n    "protocol": "tcp",\n    "appProtocol": "http"\n}\n    ],\n    "essential": true,\n    "environment": [],\n    "mountPoints": [],\n    "volumesFrom": [],\n    "logConfiguration": {\n    "logDriver": "awslogs",\n    "options": {\n    "awslogs-create-group": "true",\n    "awslogs-group": "/ecs/satellite",\n    "awslogs-region": "INSERT YOUR AWS REGION HERE",\n    "awslogs-stream-prefix": "ecs"\n}\n}\n},\n{\n    "name": "levoai-ion",\n    "image": "levoai/ion",\n    "cpu": 0,\n    "portMappings": [\n{\n    "name": "levoai-ion-8000-tcp",\n    "containerPort": 8000,\n    "hostPort": 8000,\n    "protocol": "tcp",\n    "appProtocol": "http"\n}\n    ],\n    "essential": false,\n    "environment": [],\n    "mountPoints": [],\n    "volumesFrom": [],\n    "logConfiguration": {\n    "logDriver": "awslogs",\n    "options": {\n    "awslogs-create-group": "true",\n    "awslogs-group": "/ecs/satellite",\n    "awslogs-region": "INSERT YOUR AWS REGION HERE",\n    "awslogs-stream-prefix": "ecs"\n}\n}\n}\n    ],\n    "taskRoleArn": "INSERT THE ARN OF THE ROLE YOU WANT TO ASSIGN TO THIS TASK HERE",\n    "executionRoleArn": "INSERT THE ARN OF THE ROLE YOU WANT TO ASSIGN TO THIS TASK HERE",\n    "networkMode": "awsvpc",\n    "requiresCompatibilities": [\n    "FARGATE"\n    ],\n    "cpu": "4096",\n    "memory": "8192",\n    "runtimePlatform": {\n    "cpuArchitecture": "X86_64",\n    "operatingSystemFamily": "LINUX"\n}\n}\n')),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Depending on the region you are installing in, you may need to set a different Levo base URL for the satellite."),(0,r.kt)("p",{parentName:"admonition"},"For example, if the satellite will be used with ",(0,r.kt)("inlineCode",{parentName:"p"},"app.india-1.levo.ai"),", set the ",(0,r.kt)("inlineCode",{parentName:"p"},"LEVOAI_BASE_URL")," environment variable as"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "name": "LEVOAI_BASE_URL",\n    "value": "https://api.india-1.levo.ai"\n},\n')))),(0,r.kt)(s.Z,{value:"tf",mdxType:"TabItem"},"Download the ",(0,r.kt)(f,{mdxType:"DownloadMainTF"})," file.",(0,r.kt)("p",null,"Run the following command in the same directory -"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"terraform apply\n")),(0,r.kt)("p",null,"Enter the Refresh Token and Org ID as prompted to create a task definition in your AWS account."))),(0,r.kt)("br",null),(0,r.kt)("h3",{id:"2-run-the-satellite"},"2. Run the Satellite"),(0,r.kt)("p",null,"Now that we have created a task definition, we will start our satellite up as a service in an ECS cluster."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Open the levo-satellite task definition, and click on the latest revision."),(0,r.kt)("li",{parentName:"ul"},"Head over to ",(0,r.kt)("inlineCode",{parentName:"li"},"deploy")," and select ",(0,r.kt)("inlineCode",{parentName:"li"},"Create Service"),"."),(0,r.kt)("li",{parentName:"ul"},"Choose the cluster you want to deploy the satellite."),(0,r.kt)("li",{parentName:"ul"},"Under ",(0,r.kt)("inlineCode",{parentName:"li"},"Compute Options")," select ",(0,r.kt)("inlineCode",{parentName:"li"},"Launch Type"),"."),(0,r.kt)("li",{parentName:"ul"},"Leave the other configurations on default settings, and start the service.")),(0,r.kt)("h3",{id:"3-note-down-hostport-information"},"3. Note down ",(0,r.kt)("inlineCode",{parentName:"h3"},"Host:Port")," information"),(0,r.kt)("p",null,"The collector can be accessed over the internet and its IP can be checked from within the cluster."),(0,r.kt)("p",null,"Head over to the cluster you earlier used to run the satellite on."),(0,r.kt)("p",null,"Click on Tasks and select the particular satellite task."),(0,r.kt)("p",null,"Under the ",(0,r.kt)("inlineCode",{parentName:"p"},"Container details for levoai-collector")," go to ",(0,r.kt)("inlineCode",{parentName:"p"},"Network bindings"),". It should look something like this"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"Network bindings\nHost port       Container port      Protocol        External link\n4317            4317                tcp             52.32.232.165:4317\n")),(0,r.kt)("p",null,"The Collector can now be reached by the Sensors over the internet using this ",(0,r.kt)("inlineCode",{parentName:"p"},"external-link:4317")," (Kindly add inbound rules to the security group being used by this task if you're unable to reach the satellite). Please note this, as it will be required to configure the Sensor."),(0,r.kt)("p",null,"Please proceed to ",(0,r.kt)("a",{parentName:"p",href:"/install-traffic-capture-sensors"},"install traffic capture sensors"),"."))}E.isMDXComponent=!0}}]);