"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1410],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return f}});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),h=l(n),f=i,d=h["".concat(c,".").concat(f)]||h[f]||p[f]||a;return n?r.createElement(d,o(o({ref:t},u),{},{components:n})):r.createElement(d,o({ref:t},u))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=h;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var l=2;l<a;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},2238:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return c},default:function(){return f},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return p}});var r=n(3117),i=n(102),a=(n(7294),n(3905)),o=["components"],s={},c="Content Retrieved from Cache",l={unversionedId:"Baseline/retrieved-from-cache",id:"Baseline/retrieved-from-cache",title:"Content Retrieved from Cache",description:"Content Retrieved from Cache",source:"@site/vulnerabilities/Baseline/retrieved-from-cache.md",sourceDirName:"Baseline",slug:"/Baseline/retrieved-from-cache",permalink:"/vulnerabilities/next/Baseline/retrieved-from-cache",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Sub Optimal Cache Control Directives",permalink:"/vulnerabilities/next/Baseline/re-examine-cache-control-directives"},next:{title:"Information Leak Via 'X-Powered-By' HTTP Response Header",permalink:"/vulnerabilities/next/Baseline/server-leaks-information-via-x-powered-by-http-response-header-field-s"}},u={},p=[{value:"What is it?",id:"what-is-it",level:2},{value:"References",id:"references",level:2},{value:"Test case FAQs",id:"test-case-faqs",level:2},{value:"When is this test case applicable?",id:"when-is-this-test-case-applicable",level:3},{value:"How does it work?",id:"how-does-it-work",level:2},{value:"What is the solution?",id:"what-is-the-solution",level:3}],h={toc:p};function f(e){var t=e.components,s=(0,i.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},h,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"content-retrieved-from-cache"},"Content Retrieved from Cache"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Content Retrieved from Cache",src:n(1043).Z,width:"858",height:"1216"})),(0,a.kt)("h2",{id:"what-is-it"},"What is it?"),(0,a.kt)("p",null,"The content was retrieved from a shared cache such as a CDN or Proxy Server, due the presence of HTTP response headers such as 'X-Cache', 'X-Cache-Lookup', 'Age', etc. "),(0,a.kt)("p",null,"If the response contains sensitive data (PII, PSI, PHI, etc.), this may result in sensitive information being leaked. In some cases, this may even result in a user gaining complete control of the session of another user, depending on the configuration of the caching components in use. "),(0,a.kt)("h2",{id:"references"},"References"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/04-Authentication_Testing/06-Testing_for_Browser_Cache_Weaknesses"},"Testing for Browser Cache Weaknesses"),"     "),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://cwe.mitre.org/data/definitions/525.html"},"CWE-525"))),(0,a.kt)("h2",{id:"test-case-faqs"},"Test case FAQs"),(0,a.kt)("h3",{id:"when-is-this-test-case-applicable"},"When is this test case applicable?"),(0,a.kt)("p",null,"This is applicable for all API endpoints when the ",(0,a.kt)("strong",{parentName:"p"},"Baseline")," security category is enabled in test plans."),(0,a.kt)("h2",{id:"how-does-it-work"},"How does it work?"),(0,a.kt)("p",null,"Responses sent by the API server are analyzed for the presence of HTTP headers (e.g. 'X-Cache', 'X-Cache-Lookup', 'Age', etc.) that indicate that the response content in being served from a CDN or Proxy-Cache. "),(0,a.kt)("h3",{id:"what-is-the-solution"},"What is the solution?"),(0,a.kt)("p",null,"Validate that the response does not contain sensitive data (PII, PSI, PHI, etc.). If it does, consider the use of the following HTTP response headers, to limit, or prevent the content being stored and retrieved from the cache by another user:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Cache-Control: no-cache, no-store, must-revalidate, private"),(0,a.kt)("li",{parentName:"ul"},"Pragma: no-cache Expires: 0")),(0,a.kt)("p",null,"The above configuration directs both HTTP 1.0 and HTTP 1.1 compliant caching servers to not store the response, and to not retrieve the response (without validation) from the cache, in response to a similar request."))}f.isMDXComponent=!0},1043:function(e,t,n){t.Z=n.p+"assets/images/baseline-vuln-920667aff679114e195da29f965e4d4e.svg"}}]);